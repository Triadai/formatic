!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Formatic=e()}}(function(){return function e(t,n,i){function o(l,r){if(!n[l]){if(!t[l]){var a="function"==typeof require&&require;if(!r&&a)return a(l,!0);if(s)return s(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[l]={exports:{}};t[l][0].call(d.exports,function(e){var n=t[l][1][e];return o(n?n:e)},d,d.exports,e,t,n,i)}return n[l].exports}for(var s="function"==typeof require&&require,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null;t.exports=i.createClass({displayName:"Boolean",mixins:[e("../../mixins/field")],onChange:function(e){this.onChangeValue(e)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=e.fieldBooleanChoices(t),i=e.stringToBoolean(this.props.value);return e.createElement("field",{config:e,field:t,value:i,plain:this.props.plain},e.createElement("select-value",{choices:n,value:i,onChange:this.onChange,onAction:this.onBubbleAction}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],2:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.addons.classSet;t.exports=i.createClass({displayName:"CheckboxList",mixins:[e("../../mixins/field")],getInitialState:function(){return{choices:this.props.config.fieldChoices(this.props.field)}},componentWillReceiveProps:function(e){this.setState({choices:e.config.fieldChoices(e.field)})},onChange:function(){var e=this.refs.choices.getDOMNode().getElementsByTagName("input");e=Array.prototype.slice.call(e,0);var t=e.map(function(e){return e.checked?e.value:null}).filter(function(e){return e});this.onChangeValue(t)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=this.state.choices||[],i=!s.find(n,function(e){return e.sample}),r=this.props.value||[];return e.createElement("field",{field:t,value:r},o.div({className:l(this.props.classes),ref:"choices"},n.map(function(n,s){var l=o.span({style:{whiteSpace:"nowrap"}},o.input({name:e.fieldKey(t),type:"checkbox",value:n.value,checked:r.indexOf(n.value)>=0?!0:!1,onChange:this.onChange,onFocus:this.onFocusAction,onBlur:this.onBlurAction})," ",o.span({className:"field-choice-label"},n.label));return i?o.span({key:s,className:"field-choice"},l," "):o.div({key:s,className:"field-choice"},l," ",e.createElement("sample",{field:t,choice:n}))}.bind(this))))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],3:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"Copy",mixins:[e("../../mixins/field")],render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return o.div({className:s(this.props.classes)},e.fieldHelpText(t))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],4:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.addons.classSet;t.exports=i.createClass({displayName:"Fields",mixins:[e("../../mixins/field")],onChangeField:function(e,t,n){if(e){var i=s.extend({},this.props.value);i[e]=t,this.onBubbleValue(i,n)}},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=this.props.value;return e.createElement("field",{config:e,field:t,value:n,plain:this.props.plain},o.fieldset({className:l(this.props.classes)},t.fields.map(function(t,i){var o,l=e.fieldKey(t);return l&&(o=n[l],s.isUndefined(o)&&(o=e.fieldDefaultValue(t))),e.createField({config:e,key:l||i,field:t,value:o,onChange:this.onChangeField.bind(this,l),onAction:this.onBubbleAction})}.bind(this))))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],5:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"Json",mixins:[e("../../mixins/field")],getDefaultProps:function(){return{rows:5}},isValidValue:function(e){try{return JSON.parse(e),!0}catch(t){return!1}},getInitialState:function(){return{isValid:!0,value:JSON.stringify(this.props.value,null,2)}},onChange:function(e){var t=this.isValidValue(e.target.value);t&&(this._isChanging=!0,this.onChangeValue(JSON.parse(e.target.value))),this.setState({isValid:t,value:e.target.value})},componentWillReceiveProps:function(e){this._isChanging||this.setState({isValid:!0,value:JSON.stringify(e.field.value,null,2)}),this._isChanging=!1},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return e.createElement("field",{field:t,value:this.state.value,plain:this.props.plain},o.textarea({className:s(this.props.classes),value:this.state.value,onChange:this.onChange,style:{backgroundColor:this.state.isValid?"":"rgb(255,200,200)"},rows:t.rows||this.props.rows,onFocus:this.onFocusAction,onBlur:this.onBlurAction}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],6:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.addons.classSet,r=i.createFactory(i.addons.CSSTransitionGroup);t.exports=i.createClass({displayName:"List",mixins:[e("../../mixins/field")],nextLookupId:0,getInitialState:function(){var e=[],t=this.props.value;return t.forEach(function(t,n){e[n]="_"+this.nextLookupId,this.nextLookupId++}.bind(this)),{lookups:e}},componentWillReceiveProps:function(e){var t=this.state.lookups,n=e.value;if(n.length>t.length)for(var i=t.length;i<n.length;i++)t[i]="_"+this.nextLookupId,this.nextLookupId++;this.setState({lookups:t})},onChange:function(e,t,n){var i=this.props.value.slice(0);i[e]=t,this.onBubbleValue(i,n)},onAppend:function(e){var t=this.props.config,n=t.fieldItemValue(this.props.field,e),i=this.props.value;i=i.concat(n),this.onChangeValue(i)},onRemove:function(e){var t=this.state.lookups;t.splice(e,1),this.setState({lookups:t});var n=this.props.value.slice(0);n.splice(e,1),this.onChangeValue(n)},onMove:function(e,t){var n=this.state.lookups,i=n[e],o=n[t];n[e]=o,n[t]=i,this.setState({lookups:n});var s=this.props.value.slice(0);e!==t&&e>=0&&e<s.length&&t>=0&&t<s.length&&s.splice(t,0,s.splice(e,1)[0]),this.onChangeValue(s)},getFields:function(){var e=this.props.config,t=this.props.value,n=this.props.field;return t.map(function(t,i){var o=e.fieldItemForValue(n,t);return o=s.extend({},o),o.key=i,o})},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=this.getFields(),i=this.props.value,s=n.length;return e.createElement("field",{field:t,value:i,plain:this.props.plain},o.div({className:l(this.props.classes)},r({transitionName:"reveal"},n.map(function(t,n){return e.createElement("list-item",{key:this.state.lookups[n],field:t,value:i[n],index:n,numItems:s,onMove:this.onMove,onRemove:this.onRemove,onChange:this.onChange,onAction:this.onBubbleAction})}.bind(this))),e.createElement("list-control",{field:t,onAppend:this.onAppend})))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],7:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.addons.classSet,r=i.createFactory(i.addons.CSSTransitionGroup),a="$$__temp__",c=function(e){return a+e},d=function(e){return e.substring(0,a.length)===a};t.exports=i.createClass({displayName:"Object",mixins:[e("../../mixins/field")],nextLookupId:0,getInitialState:function(){var e={},t=Object.keys(this.props.value),n=[],i={};return t.forEach(function(t){var o=++this.nextLookupId;e[t]=o,n.push(t),d(t)&&(i[o]="")}.bind(this)),{keyToId:e,keyOrder:n,tempDisplayKeys:i}},componentWillReceiveProps:function(e){var t=this.state.keyToId,n={},i=this.state.tempDisplayKeys,o={},s=this.state.keyOrder,l=Object.keys(e.value),r=[];l.forEach(function(e){t[e]?n[e]=t[e]:(this.nextLookupId++,n[e]=this.nextLookupId,r.push(e)),d(e)&&n[e]in i&&(o[n[e]]=i[n[e]])}.bind(this));var a=[];s.forEach(function(e){n[e]&&a.push(e)}),a=a.concat(r),this.setState({keyToId:n,keyOrder:a,tempDisplayKeys:o})},onChange:function(e,t,n){var i=s.extend({},this.props.value);i[e]=t,this.onBubbleValue(i,n)},onAppend:function(e){var t=this.props.config;this.nextLookupId++;var n=this.state.keyToId,i=this.state.keyOrder,o=this.state.tempDisplayKeys,l=this.nextLookupId,r=c(l);n[r]=l,o[l]="",i.push(r),this.setState({keyToId:n,tempDisplayKeys:o,keyOrder:i});var a=s.extend(this.props.value);a[r]=t.fieldItemValue(this.props.field,e),this.onChangeValue(a)},onRemove:function(e){var t=s.extend(this.props.value);delete t[e],this.onChangeValue(t)},onMove:function(e,t){if(e!==t){var n=this.state.keyToId,i=this.state.keyOrder,o=this.state.tempDisplayKeys,l=s.extend(this.props.value);if(n[t]){var r=c(n[t]);o[n[t]]=t,n[r]=n[t],i[i.indexOf(t)]=r,delete n[t],this.setState({keyToId:n,tempDisplayKeys:o,keyOrder:i}),l[r]=l[t],delete l[t]}t||(t=c(n[e]),o[n[e]]=""),n[t]=n[e],i[i.indexOf(e)]=t,this.setState({keyToId:n,keyOrder:i}),l[t]=l[e],delete l[e],this.onChangeValue(l)}},getFields:function(){var e=this.props.config,t=this.props.value,n=this.props.field;return this.state.keyOrder.map(function(i){var o=e.fieldItemForValue(n,t[i]);return o=s.extend({},o),o.key=i,o})},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=this.getFields();return e.createElement("field",{field:t,value:this.props.value,plain:this.props.plain},o.div({className:l(this.props.classes)},r({transitionName:"reveal"},n.map(function(t){var n=this.state.tempDisplayKeys[this.state.keyToId[t.key]];return s.isUndefined(n)&&(n=t.key),e.createElement("object-item",{key:this.state.keyToId[t.key],field:t,onMove:this.onMove,onRemove:this.onRemove,onChange:this.onChange,onAction:this.onBubbleAction,displayKey:n,itemKey:t.key})}.bind(this))),e.createElement("object-control",{field:t,onAppend:this.onAppend})))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],8:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.addons.classSet,r=e("../../utils"),a=function(e){return e.replace(/ /g," ")},c="  ",d="  ",f=/^[0-9]+__/,u=function(e){return f.test(e)?e.replace(f,""):e},p=function(e,t){var n=t.getBoundingClientRect();return e.x>=n.left&&e.x<=n.right&&e.y>=n.top&&e.y<=n.bottom?!0:void 0},h=function(e,t){return t=t||"text",{type:t,value:e}},m=function(e){e=e||"";var t=e.split(/{{(?!{)/),n=[];return""!==t[0]&&(n=[h(t[0])]),t=n.concat(t.slice(1).map(function(e){return e.indexOf("}}")>=0?[h(e.substring(0,e.indexOf("}}")),"tag"),h(e.substring(e.indexOf("}}")+2))]:h("{{"+e,"text")})),[].concat.apply([],t)};t.exports=i.createClass({displayName:"TaggedText",mixins:[e("../../mixins/field"),e("../../mixins/undo-stack"),e("../../mixins/resize")],getReplaceState:function(e){var t=e.config.fieldReplaceChoices(e.field),n={};return t.forEach(function(e){n[e.value]=e.label}),{replaceChoices:t,replaceChoicesLabels:n}},getInitialState:function(){var e=this.getReplaceState(this.props);return{undoDepth:100,isChoicesOpen:!1,hoverPillRef:null,replaceChoices:e.replaceChoices,replaceChoicesLabels:e.replaceChoicesLabels}},componentWillReceiveProps:function(e){this.setState(this.getReplaceState(e))},componentWillMount:function(){this.tracking={};var e=m(this.props.value),t=this.tokens(e),n=this.indexMap(t);this.tracking.pos=n.length,this.tracking.range=0,this.tracking.tokens=t,this.tracking.indexMap=n},getStateSnapshot:function(){return{value:this.props.value,pos:this.tracking.pos,range:this.tracking.range}},setStateSnapshot:function(e){this.tracking.pos=e.pos,this.tracking.range=e.range,this.onChangeValue(e.value)},tokens:function(e){return[].concat.apply([],e.map(function(e){return"tag"===e.type?e:e.value.split("")}))},indexMap:function(e){var t=[];return s.each(e,function(e,n){if("tag"===e.type){var i=c+a(this.prettyLabel(e.value))+d,o=i.split("");s.each(o,function(){t.push(n)})}else t.push(n)}.bind(this)),t},onScroll:function(){this.refs.highlight.getDOMNode().scrollTop=this.refs.content.getDOMNode().scrollTop,this.refs.highlight.getDOMNode().scrollLeft=this.refs.content.getDOMNode().scrollLeft},tokenIndex:function(e,t,n){if(0>e)e=0;else if(e>=n.length)return t.length;return n[e]},onChange:function(e){var t=e.target,n=this.tracking.pos,i=this.tracking.range,o=t.selectionStart,s=this.tracking.tokens,l=this.tokenIndex(n,s,this.tracking.indexMap),r=this.tokenIndex(n+i,s,this.tracking.indexMap),a=r-l;if(a>0&&(s.splice(l,a),this.tracking.indexMap=this.indexMap(s)),o>n){var c=t.value.substring(n,o);s.splice(l,0,c)}if(n>o){var d=this.tokenAt(o),f=this.tokenBefore(o);d===f&&(o=this.moveOffTag(o,s,this.indexMap(s),-1));var u=this.tokenIndex(o,s,this.tracking.indexMap);s.splice(u,l-u)}var p=this.rawValue(s);this.tracking.pos=o,this.tracking.range=0,this.onChangeValue(p),this.snapshot()},componentDidUpdate:function(){var e=this.props.value||"",t=m(e);this.tracking.tokens=this.tokens(t),this.tracking.indexMap=this.indexMap(this.tracking.tokens);var n=this.normalizePosition(this.tracking.pos),i=this.tracking.range,o=this.normalizePosition(n+i);i=o-n,this.tracking.pos=n,this.tracking.range=i,document.activeElement===this.refs.content.getDOMNode()&&this.refs.content.getDOMNode().setSelectionRange(n,n+i)},prettyLabel:function(e){if(this.state.replaceChoicesLabels[e])return this.state.replaceChoicesLabels[e];var t=u(e);return this.props.config.humanize(t)},plainValue:function(e){var t=m(e);return t.map(function(e){return"text"===e.type?e.value:c+a(this.prettyLabel(e.value))+d}.bind(this)).join("")},prettyValue:function(e){var t=m(e);return t.map(function(e,n){if("text"===e.type)return n===t.length-1&&"\n"===e.value[e.value.length-1]?e.value+" ":e.value;var i="prettyPart"+n,s="pretty-part";return this.state.hoverPillRef&&i===this.state.hoverPillRef&&(s+=" pretty-part-hover"),o.span({key:n,className:s,ref:i,"data-pretty":!0,"data-ref":i},o.span({className:"pretty-part-left"},c),o.span({className:"pretty-part-text"},a(this.prettyLabel(e.value))),o.span({className:"pretty-part-right"},d))}.bind(this))},rawValue:function(e){return e.map(function(e){return"tag"===e.type?"{{"+e.value+"}}":e}).join("")},moveOffTag:function(e,t,n,i){i="undefined"==typeof i||i>0?1:-1;var o;if(i>0)for(o=t[n[e]];e<n.length&&"tag"===t[n[e]].type&&t[n[e]]===o;)e++;else for(o=t[n[e-1]];e>0&&"tag"===t[n[e-1]].type&&t[n[e-1]]===o;)e--;return e},tokenAt:function(e){return e>=this.tracking.indexMap.length?null:(0>e&&(e=0),this.tracking.tokens[this.tracking.indexMap[e]])},tokenBefore:function(e){return e>=this.tracking.indexMap.length&&(e=this.tracking.indexMap.length),0>=e?null:this.tracking.tokens[this.tracking.indexMap[e-1]]},normalizePosition:function(e,t){if(s.isUndefined(t)&&(t=e),0>=e||e>=this.tracking.indexMap.length)return 0>e&&(e=0),e>this.tracking.indexMap.length&&(e=this.tracking.indexMap.length),e;var n=this.tokenAt(e),i=this.tokenBefore(e);if(n!==i)return e;var o=this.tokenAt(t),l=this.tokenBefore(t),r=this.moveOffTag(e,this.tracking.tokens,this.tracking.indexMap),a=this.moveOffTag(e,this.tracking.tokens,this.tracking.indexMap,-1);if(o!==l){if(o===n)return r;if(l===n)return a}var c=r;return(e===t||t>e)&&r-e>e-a&&(c=a),c},onSelect:function(e){var t=e.target,n=t.selectionStart,i=t.selectionEnd;if(n===i&&this.state.hoverPillRef){var o=this.tokenAt(n),s=this.tokenBefore(n);if(o&&o===s&&o.type&&"tag"===o.type){var l=this.moveOffTag(n,this.tracking.tokens,this.tracking.indexMap),r=this.moveOffTag(n,this.tracking.tokens,this.tracking.indexMap,-1);return this.tracking.pos=r,this.tracking.range=l-r,t.selectionStart=r,t.selectionEnd=l,void(this.state.isChoicesOpen||this.setChoicesOpen(!0))}}n=this.normalizePosition(n,this.tracking.pos),i=this.normalizePosition(i,this.tracking.pos+this.tracking.range),this.tracking.pos=n,this.tracking.range=i-n,t.selectionStart=n,t.selectionEnd=i},onCopy:function(){var e=this.refs.content.getDOMNode(),t=e.selectionStart,n=e.selectionEnd,i=e.value.substring(t,n),o=this.tokenIndex(t,this.tracking.tokens,this.tracking.indexMap),s=this.tokenIndex(n,this.tracking.tokens,this.tracking.indexMap),l=this.tracking.tokens.slice(o,s);i=this.rawValue(l);var r=e.value;e.value=e.value+i,e.setSelectionRange(r.length,r.length+i.length),window.setTimeout(function(){e.value=r,e.setSelectionRange(t,n)},0)},onCut:function(){var e=this.refs.content.getDOMNode(),t=e.selectionStart,n=e.selectionEnd,i=e.value.substring(t,n),o=this.tokenIndex(t,this.tracking.tokens,this.tracking.indexMap),s=this.tokenIndex(n,this.tracking.tokens,this.tracking.indexMap),l=this.tracking.tokens.slice(o,s);i=this.rawValue(l);var r=e.value,a=e.value.substring(0,t)+e.value.substring(n);e.value=e.value+i,e.setSelectionRange(r.length,r.length+i.length);var c=this.tracking.tokens.slice(0,o).concat(this.tracking.tokens.slice(s));window.setTimeout(function(){e.value=a,e.setSelectionRange(t,t),this.tracking.pos=t,this.tracking.range=0,this.tracking.tokens=c,this.tracking.indexMap=this.indexMap(this.tracking.tokens);var n=this.rawValue(this.tracking.tokens);this.onChangeValue(n),this.snapshot()}.bind(this),0)},onKeyDown:function(e){37===e.keyCode?this.leftArrowDown=!0:39===e.keyCode&&(this.rightArrowDown=!0),90!==e.keyCode||!e.metaKey&&!e.ctrlKey||e.shiftKey?(89===e.keyCode&&e.ctrlKey&&!e.shiftKey||90===e.keyCode&&e.metaKey&&e.shiftKey)&&this.redo():(e.preventDefault(),this.undo())},onKeyUp:function(e){37===e.keyCode?this.leftArrowDown=!1:39===e.keyCode&&(this.rightArrowDown=!1)},adjustStyles:function(e){var t=this.refs.highlight.getDOMNode(),n=this.refs.content.getDOMNode(),i=window.getComputedStyle(n),o=i.backgroundColor;if(r.copyElementStyle(n,t),t.style.position="absolute",t.style.whiteSpace="pre-wrap",t.style.color="rgba(0,0,0,0)",t.style.webkitTextFillColor="rgba(0,0,0,0)",t.style.resize="none",t.style.borderColor="rgba(0,0,0,0)",r.browser.isMozilla){var s=parseFloat(i.paddingTop),l=parseFloat(i.paddingBottom),a=parseFloat(i.borderTopWidth),c=parseFloat(i.borderBottomWidth);t.style.paddingTop="0px",t.style.paddingBottom="0px",t.style.height=n.clientHeight-s-l+a+c+"px",t.style.top=i.paddingTop,t.style.boxShadow="none"}e&&(this.backgroundColor=o),t.style.backgroundColor=this.backgroundColor,n.style.backgroundColor="rgba(0,0,0,0)"},onResize:function(){this.adjustStyles()},onResizeWindow:function(){this.adjustStyles()},componentDidMount:function(){this.adjustStyles(!0),this.setOnResize("content",this.onResize)},onInsertFromSelect:function(e){if(e.target.selectedIndex>0){var t=e.target.value;e.target.selectedIndex=0;var n=this.tracking.pos,i=this.normalizePosition(n),o=this.tracking.tokens,s=this.tokenIndex(i,o,this.tracking.indexMap);o.splice(s,0,{type:"tag",value:t}),this.tracking.indexMap=this.indexMap(o);var l=this.rawValue(o);this.tracking.pos+=this.prettyLabel(t).length,this.onChangeValue(l),this.refs.content.getDOMNode().focus()}},onInsert:function(e){var t=e,n=this.tracking.pos,i=this.tracking.pos+this.tracking.range,o=this.normalizePosition(n),s=this.normalizePosition(i),l=this.tracking.tokens,r=this.tokenIndex(o,l,this.tracking.indexMap),a=this.tokenIndex(s,l,this.tracking.indexMap);l.splice(r,a-r,{type:"tag",value:t}),this.tracking.indexMap=this.indexMap(l);var c=this.rawValue(l);this.tracking.pos+=this.prettyLabel(t).length,this.onChangeValue(c),this.setState({isChoicesOpen:!1}),this.refs.content.getDOMNode().focus()},onToggleChoices:function(){this.setChoicesOpen(!this.state.isChoicesOpen)},onCloseChoices:function(){this.state.isChoicesOpen&&this.setChoicesOpen(!1)},setChoicesOpen:function(e){this.onStartAction(e?"open-replacements":"close-replacements"),this.setState({isChoicesOpen:e})},closeChoices:function(){},getCloseIgnoreNodes:function(){return this.refs.toggle.getDOMNode()},onClickOutsideChoices:function(){},onMouseMove:function(e){for(var t={x:e.clientX,y:e.clientY},n=this.refs.highlight.getDOMNode().childNodes,i=null,o=0;o<n.length;o++){var s=n[o];if(n[o].getAttribute("data-pretty")&&p(t,s)){i=s;break}}i?this.state.hoverPillRef!==i.getAttribute("data-ref")&&this.setState({hoverPillRef:i.getAttribute("data-ref")}):this.state.hoverPillRef&&this.setState({hoverPillRef:null})},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=this.state.replaceChoices;return e.createElement("field",{field:t,value:this.props.value,plain:this.props.plain},o.div({style:{position:"relative"}},o.pre({className:"pretty-highlight",ref:"highlight"},this.prettyValue(this.props.value)),(e.fieldIsSingleLine(t)?o.input:o.textarea)({type:"text",className:l(s.extend({},this.props.classes,{"pretty-content":!0})),ref:"content",rows:t.rows||this.props.rows,name:e.fieldKey(t),value:this.plainValue(this.props.value),onChange:this.onChange,onScroll:this.onScroll,style:{position:"relative",top:0,left:0,cursor:this.state.hoverPillRef?"pointer":null},onKeyPress:this.onKeyPress,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onSelect:this.onSelect,onCopy:this.onCopy,onCut:this.onCut,onMouseMove:this.onMouseMove,onFocus:this.onFocusAction,onBlur:this.onBlurAction}),o.a({ref:"toggle",href:"JavaScript:",onClick:this.onToggleChoices},"Insert..."),e.createElement("choices",{ref:"choices",choices:n,open:this.state.isChoicesOpen,onSelect:this.onInsert,onClose:this.onCloseChoices,ignoreCloseNodes:this.getCloseIgnoreNodes})))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35,"../../mixins/resize":38,"../../mixins/undo-stack":40,"../../utils":42}],9:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null;t.exports=i.createClass({displayName:"Select",mixins:[e("../../mixins/field")],getInitialState:function(){return{choices:this.props.config.fieldChoices(this.props.field)}},componentWillReceiveProps:function(e){this.setState({choices:e.config.fieldChoices(e.field)})},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return e.createElement("field",{config:e,field:t,value:this.props.value,plain:this.props.plain},e.createElement("select-value",{choices:this.state.choices,value:this.props.value,onChange:this.onChangeValue,onAction:this.onBubbleAction}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],10:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"Text",mixins:[e("../../mixins/field")],onChange:function(e){this.onChangeValue(e.target.value)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return e.createElement("field",{config:e,field:t,value:this.props.value,plain:this.props.plain},o.textarea({value:this.props.value,className:s(this.props.classes),rows:t.rows||this.props.rows,onChange:this.onChange,onFocus:this.onFocusAction,onBlur:this.onBlurAction}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],11:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"Unicode",mixins:[e("../../mixins/field")],onChange:function(e){this.onChangeValue(e.target.value)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return e.createElement("field",{config:e,field:t,value:this.props.value,plain:this.props.plain},o.input({type:"text",value:this.props.value,className:s(this.props.classes),onChange:this.onChange,onFocus:this.onFocusAction,onBlur:this.onBlurAction}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],12:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM;t.exports=i.createClass({displayName:"Unknown",mixins:[e("../../mixins/field")],render:function(){return this.renderWithConfig()},renderDefault:function(){return o.div({},o.div({},"Component not found for: "),o.pre({},JSON.stringify(this.props.field,null,2)))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/field":35}],13:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"AddItem",mixins:[e("../../mixins/helper")],getDefaultProps:function(){return{label:"[add]"}},render:function(){return this.renderWithConfig()},renderDefault:function(){return o.span({className:s(this.props.classes),onClick:this.props.onClick},this.props.label)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],14:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.createFactory(i.addons.CSSTransitionGroup);t.exports=i.createClass({displayName:"Choices",mixins:[e("../../mixins/helper"),e("../../mixins/click-outside")],getInitialState:function(){return{maxHeight:null,open:this.props.open}},getIgnoreCloseNodes:function(){if(!this.props.ignoreCloseNodes)return[];var e=this.props.ignoreCloseNodes();return s.isArray(e)||(e=[e]),e},componentDidMount:function(){this.setOnClickOutside("choices",function(e){s.find(this.getIgnoreCloseNodes(),function(t){return this.isNodeInside(e.target,t)}.bind(this))||this.props.onClose()}.bind(this)),this.adjustSize()},onSelect:function(e){this.props.onSelect(e.value)},onResizeWindow:function(){this.adjustSize()},onScrollWindow:function(){this.adjustSize()},adjustSize:function(){if(this.refs.choices){var e=this.refs.choices.getDOMNode(),t=e.getBoundingClientRect(),n=t.top,i=window.innerHeight,o=i-n;this.setState({maxHeight:o})}},componentWillReceiveProps:function(e){this.setState({open:e.open},function(){this.adjustSize()}.bind(this))},onScroll:function(){},onWheel:function(){},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.choices;return e&&0===e.length&&(e=[{value:"///empty///"}]),o.div({ref:"container",onWheel:this.onWheel,onScroll:this.onScroll,className:"choices-container",style:{userSelect:"none",WebkitUserSelect:"none",position:"absolute",maxHeight:this.state.maxHeight?this.state.maxHeight:null}},l({transitionName:"reveal"},this.props.open?o.ul({ref:"choices",className:"choices"},e.map(function(e,t){var n=null;return n="///loading///"===e.value?o.a({href:"JavaScript:",onClick:this.props.onClose},o.span({className:"choice-label"},"Loading...")):"///empty///"===e.value?o.a({href:"JavaScript:",onClick:this.props.onClose},o.span({className:"choice-label"},"No choices available.")):o.a({href:"JavaScript:",onClick:this.onSelect.bind(this,e)},o.span({className:"choice-label"},e.label),o.span({className:"choice-sample"},e.sample)),o.li({key:t,className:"choice"},n)}.bind(this))):null))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/click-outside":34,"../../mixins/helper":36}],15:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.addons.classSet,r=i.createFactory(i.addons.CSSTransitionGroup);t.exports=i.createClass({displayName:"Field",mixins:[e("../../mixins/helper")],getInitialState:function(){return{collapsed:this.props.field.collapsed?!0:!1}},isCollapsible:function(){var e=this.props.field;return!s.isUndefined(e.collapsed)||!s.isUndefined(e.collapsible)},onClickLabel:function(){this.setState({collapsed:!this.state.collapsed})},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config;if(this.props.plain)return this.props.children;var t=this.props.field,n=this.props.index;if(!s.isNumber(n)){var i=e.fieldKey(t);n=s.isNumber(i)?i:void 0}var a=s.extend({},this.props.classes);return e.fieldRequired(t)?(a.required=!0,(s.isUndefined(this.props.value)||""===this.props.value)&&(a["validation-error-required"]=!0)):a.optional=!0,o.div({className:l(a),style:{display:t.hidden?"none":""}},e.createElement("label",{config:e,field:t,index:n,onClick:this.isCollapsible()?this.onClickLabel:null}),r({transitionName:"reveal"},this.state.collapsed?[]:[e.createElement("help",{config:e,key:"help",field:t}),this.props.children]))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],16:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"Help",mixins:[e("../../mixins/helper")],render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=e.fieldHelpText(t);return n?o.div({className:s(this.props.classes),dangerouslySetInnerHTML:{__html:n}}):o.span(null)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],17:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ItemChoices",mixins:[e("../../mixins/helper")],onChange:function(e){this.props.onSelect(parseInt(e.target.value))},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=e.fieldItems(t),i=null;return n.length>1&&(i=o.select({className:s(this.props.classes),value:this.value,onChange:this.onChange},n.map(function(e,t){return o.option({key:t,value:t},e.label||t)}))),i?i:o.span(null)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})
},{"../../mixins/helper":36}],18:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"Label",mixins:[e("../../mixins/helper")],render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=e.fieldLabel(t),i=null;if("number"==typeof this.props.index&&(i=""+(this.props.index+1)+".",n&&(i=i+" "+n)),n||i){var l=i||n;this.props.onClick&&(l=o.a({href:"JavaScript:",onClick:this.props.onClick},l)),i=o.label({},l)}var r;return e.fieldHasValueChildren(t)||(r=o.span({className:e.fieldRequired(t)?"required-text":"not-required-text"})),o.div({className:s(this.props.classes)},i," ",r)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],19:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ListControl",mixins:[e("../../mixins/helper")],getInitialState:function(){return{itemIndex:0}},onSelect:function(e){this.setState({itemIndex:e})},onAppend:function(){this.props.onAppend(this.state.itemIndex)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=e.fieldItems(t),i=null;return n.length>0&&(i=e.createElement("item-choices",{field:t,value:this.state.itemIndex,onSelect:this.onSelect})),o.div({className:s(this.props.classes)},i," ",e.createElement("add-item",{onClick:this.onAppend}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],20:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ListItemControl",mixins:[e("../../mixins/helper")],onMoveBack:function(){this.props.onMove(this.props.index,this.props.index-1)},onMoveForward:function(){this.props.onMove(this.props.index,this.props.index+1)},onRemove:function(){this.props.onRemove(this.props.index)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return o.div({className:s(this.props.classes)},e.createElement("remove-item",{field:t,onClick:this.onRemove}),this.props.index>0?e.createElement("move-item-back",{onClick:this.onMoveBack}):null,this.props.index<this.props.numItems-1?e.createElement("move-item-forward",{onClick:this.onMoveForward}):null)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],21:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ListItemValue",mixins:[e("../../mixins/helper")],onChangeField:function(e,t){this.props.onChange(this.props.index,e,t)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=this.props.value;return o.div({className:s(this.props.classes)},e.createField({field:t,value:n,onChange:this.onChangeField,onAction:this.onBubbleAction}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],22:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ListItem",mixins:[e("../../mixins/helper")],render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return o.div({className:s(this.props.className)},e.createElement("list-item-value",{field:t,value:this.props.value,index:this.props.index,onChange:this.props.onChange,onAction:this.onBubbleAction}),e.createElement("list-item-control",{field:t,index:this.props.index,numItems:this.props.numItems,onMove:this.props.onMove,onRemove:this.props.onRemove}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],23:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"MoveItemBack",mixins:[e("../../mixins/helper")],getDefaultProps:function(){return{label:"[up]"}},render:function(){return this.renderWithConfig()},renderDefault:function(){return o.span({className:s(this.props.classes),onClick:this.props.onClick},this.props.label)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],24:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"MoveItemForward",mixins:[e("../../mixins/helper")],getDefaultProps:function(){return{label:"[down]"}},render:function(){return this.renderWithConfig()},renderDefault:function(){return o.span({className:s(this.props.classes),onClick:this.props.onClick},this.props.label)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],25:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ObjectControl",mixins:[e("../../mixins/helper")],getInitialState:function(){return{itemIndex:0}},onSelect:function(e){this.setState({itemIndex:e})},onAppend:function(){this.props.onAppend(this.state.itemIndex)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field,n=e.fieldItems(t),i=null;return n.length>0&&(i=e.createElement("item-choices",{field:t,value:this.state.itemIndex,onSelect:this.onSelect})),o.div({className:s(this.props.classes)},i," ",e.createElement("add-item",{onClick:this.onAppend}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],26:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ObjectItemControl",mixins:[e("../../mixins/helper")],onRemove:function(){this.props.onRemove(this.props.itemKey)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return o.div({className:s(this.props.classes)},e.createElement("remove-item",{field:t,onClick:this.onRemove}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],27:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ObjectItemKey",mixins:[e("../../mixins/helper")],onChange:function(e){this.props.onChange(e.target.value)},render:function(){return this.renderWithConfig()},renderDefault:function(){return o.input({className:s(this.props.className),type:"text",value:this.props.displayKey,onChange:this.onChange})}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],28:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ObjectItemValue",mixins:[e("../../mixins/helper")],onChangeField:function(e,t){this.props.onChange(this.props.itemKey,e,t)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return o.div({className:s(this.props.className)},e.createField({field:t,onChange:this.onChangeField,plain:!0}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],29:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"ObjectItem",mixins:[e("../../mixins/helper")],onChangeKey:function(e){this.props.onMove(this.props.itemKey,e)},render:function(){return this.renderWithConfig()},renderDefault:function(){var e=this.props.config,t=this.props.field;return o.div({className:s(this.props.className)},e.createElement("object-item-key",{field:t,onChange:this.onChangeKey,displayKey:this.props.displayKey,itemKey:this.props.itemKey}),e.createElement("object-item-value",{field:t,onChange:this.props.onChange,itemKey:this.props.itemKey}),e.createElement("object-item-control",{field:t,onRemove:this.props.onRemove,itemKey:this.props.itemKey}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],30:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s=i.addons.classSet;t.exports=i.createClass({displayName:"RemoveItem",mixins:[e("../../mixins/helper")],getDefaultProps:function(){return{label:"[remove]"}},render:function(){return this.renderWithConfig()},renderDefault:function(){return o.span({className:s(this.props.classes),onClick:this.props.onClick},this.props.label)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],31:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.addons.classSet;t.exports=i.createClass({displayName:"SelectValue",mixins:[e("../../mixins/helper")],onChange:function(e){var t=e.target.value,n=t.substring(0,t.indexOf(":"));if("choice"===n){var i=t.substring(t.indexOf(":")+1);i=parseInt(i),this.props.onChange(this.props.choices[i].value)}},render:function(){return this.renderWithConfig()},renderDefault:function(){var e,t=this.props.choices||[];if(1===t.length&&"///loading///"===t[0].value)e=o.div({},"Loading choices...");else{var n=void 0!==this.props.value?this.props.value:"";t=t.map(function(e,t){return{choiceValue:"choice:"+t,value:e.value,label:e.label}});var i=s.find(t,function(e){return e.value===n});if(void 0===i){var r=n;s.isString(n)||(r=JSON.stringify(n)),i={choiceValue:"value:",value:n,label:r},t=[i].concat(t)}e=o.select({className:l(this.props.classes),onChange:this.onChange,value:i.choiceValue,onFocus:this.onFocusAction,onBlur:this.onBlurAction},t.map(function(e,t){return o.option({key:t,value:e.choiceValue},e.label)}.bind(this)))}return e}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../mixins/helper":36}],32:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,s=e("./utils"),l=function(){return""},r=function(){return{}},a=function(){return[]},c=function(){return!1};t.exports={createElement_Fields:i.createFactory(e("./components/fields/fields")),createElement_Text:i.createFactory(e("./components/fields/text")),createElement_Unicode:i.createFactory(e("./components/fields/unicode")),createElement_Select:i.createFactory(e("./components/fields/select")),createElement_Boolean:i.createFactory(e("./components/fields/boolean")),createElement_PrettyText:i.createFactory(e("./components/fields/pretty-text")),createElement_List:i.createFactory(e("./components/fields/list")),createElement_CheckboxList:i.createFactory(e("./components/fields/checkbox-list")),createElement_Object:i.createFactory(e("./components/fields/object")),createElement_Json:i.createFactory(e("./components/fields/json")),createElement_UnknownField:i.createFactory(e("./components/fields/unknown")),createElement_Copy:i.createFactory(e("./components/fields/copy")),createElement_Field:i.createFactory(e("./components/helpers/field")),createElement_Label:i.createFactory(e("./components/helpers/label")),createElement_Help:i.createFactory(e("./components/helpers/help")),createElement_Choices:i.createFactory(e("./components/helpers/choices")),createElement_ListControl:i.createFactory(e("./components/helpers/list-control")),createElement_ListItemControl:i.createFactory(e("./components/helpers/list-item-control")),createElement_ListItemValue:i.createFactory(e("./components/helpers/list-item-value")),createElement_ListItem:i.createFactory(e("./components/helpers/list-item")),createElement_ItemChoices:i.createFactory(e("./components/helpers/item-choices")),createElement_AddItem:i.createFactory(e("./components/helpers/add-item")),createElement_RemoveItem:i.createFactory(e("./components/helpers/remove-item")),createElement_MoveItemForward:i.createFactory(e("./components/helpers/move-item-forward")),createElement_MoveItemBack:i.createFactory(e("./components/helpers/move-item-back")),createElement_ObjectControl:i.createFactory(e("./components/helpers/object-control")),createElement_ObjectItemControl:i.createFactory(e("./components/helpers/object-item-control")),createElement_ObjectItemValue:i.createFactory(e("./components/helpers/object-item-value")),createElement_ObjectItemKey:i.createFactory(e("./components/helpers/object-item-key")),createElement_ObjectItem:i.createFactory(e("./components/helpers/object-item")),createElement_SelectValue:i.createFactory(e("./components/helpers/select-value")),defaultValue_Fields:r,defaultValue_Text:l,defaultValue_Unicode:l,defaultValue_Select:l,defaultValue_List:a,defaultValue_Object:r,defaultValue_Json:r,defaultValue_Boolean:c,defaultValue_CheckboxList:a,hasElementFactory:function(e){var t=this;return t["createElement_"+e]?!0:!1},createElement:function(e,t,n){var i=this;if(t.config||(t=o.extend({},t,{config:i})),e=i.elementName(e),i["createElement_"+e])return i["createElement_"+e](t,n);if("Unknown"!==e&&i.hasElementFactory("Unknown"))return i.createElement("Unknown",t,n);throw new Error("Factory not found for: "+e)},createField:function(e){var t=this,n=t.fieldTypeName(e.field);return t.hasElementFactory(n)?t.createElement(n,e):t.createElement("UnknownField",e)},renderComponent:function(e){var t=this,n=e.constructor.displayName;return t["renderComponent_"+n]?t["renderComponent_"+n](e):e.renderDefault()},renderFieldComponent:function(e){var t=this;return t.renderComponent(e)},elementName:function(e){return s.dashToPascal(e)},alias_Dict:"Object",alias_Bool:"Boolean",alias_PrettyTextarea:"PrettyText",alias_Unicode:function(e){return e.replaceChoices?"PrettyText":"Unicode"},alias_Text:function(e){return e.replaceChoices?"PrettyText":"Text"},fieldTypeName:function(e){var t=this,n=s.dashToPascal(e.type),i=t["alias_"+n];return i?o.isFunction(i)?i(e):i:(e.list&&(n="List"),n)},fieldKey:function(e){return e.key},fieldDefaultValue:function(e){var t=this;if(!o.isUndefined(e.default))return s.deepCopy(e.default);var n=t.fieldTypeName(e);return t["defaultValue_"+n]?t["defaultValue_"+n](e):""},fieldChoices:function(e){var t=this;return t.normalizeChoices(e.choices)},fieldBooleanChoices:function(e){var t=this,n=t.fieldChoices(e);return 0===n.length?[{label:"Yes",value:!0},{label:"No",value:!1}]:n.map(function(e){return o.isBoolean(e.value)?e:o.extend({},e,{value:t.stringToBoolean(e.value)})})},fieldReplaceChoices:function(e){var t=this;return t.normalizeChoices(e.replaceChoices)},fieldLabel:function(e){return e.label},fieldHelpText:function(e){return e.help_text_html||e.help_text||e.helpText||e.helpTextHtml},fieldRequired:function(e){return e.required},fieldHasValueChildren:function(e){var t=this,n=t.fieldDefaultValue(e);return o.isObject(n)||o.isArray(n)?!0:!1},fieldItems:function(e){return e.items?o.isArray(e.items)?e.items:[e.items]:[]},fieldItemForValue:function(e,t){var n,i=this;return e.items&&(n=o.isArray(e.items)?0===e.items.length?e.items[0]:o.find(e.items,function(e){return i.itemMatchesValue(e,t)}):e.items),n?n:i.fieldForValue(t)},fieldItemValue:function(e,t){var n=this,i=n.fieldItems(e)[t];return i?o.isUndefined(i.default)&&!o.isUndefined(i.match)?s.deepCopy(i.match):n.fieldDefaultValue(i):""},fieldIsSingleLine:function(e){return e.isSingleLine||e.is_single_line||"unicode"===e.type||"Unicode"===e.type},itemMatchesValue:function(e,t){var n=e.match;return n?o.every(o.keys(n),function(e){return o.isEqual(n[e],t[e])}):!0},fieldForValue:function(e){var t=this,n={type:"json"};if(o.isString(e))n={type:"text"};else if(o.isNumber(e))n={type:"number"};else if(o.isBoolean(e))n={type:"boolean"};else if(o.isArray(e)){var i=e.map(function(e,n){var i=t.fieldForValue(e);return i.key=n,i});n={type:"list",fields:i}}else if(o.isObject(e)){var s=Object.keys(e).map(function(n){var i=t.fieldForValue(e[n]);return i.key=n,i.label=t.humanize(n),i});n={type:"object",fields:s}}else o.isNull(e)&&(n={type:"json"});return n},humanize:function(e){return e=e.replace(/\{\{/g,""),e=e.replace(/\}\}/g,""),e.replace(/_/g," ").replace(/(\w+)/g,function(e){return e.charAt(0).toUpperCase()+e.slice(1)})},normalizeChoices:function(e){var t=this;return e?(o.isString(e)&&(e=e.split(",")),!o.isArray(e)&&o.isObject(e)&&(e=Object.keys(e).map(function(t){return{value:t,label:e[t]}})),e=e.slice(0),e=o.flatten(e),e.forEach(function(n,i){o.isString(n)&&(e[i]={value:n,label:t.humanize(n)}),e[i].label||(e[i].label=t.humanize(e[i].value))}),e):[]},stringToBoolean:function(e){return o.isString(e)?(e=e.toLowerCase(),""===e||"no"===e||"off"===e||"false"===e?!1:!0):e?!0:!1}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./components/fields/boolean":1,"./components/fields/checkbox-list":2,"./components/fields/copy":3,"./components/fields/fields":4,"./components/fields/json":5,"./components/fields/list":6,"./components/fields/object":7,"./components/fields/pretty-text":8,"./components/fields/select":9,"./components/fields/text":10,"./components/fields/unicode":11,"./components/fields/unknown":12,"./components/helpers/add-item":13,"./components/helpers/choices":14,"./components/helpers/field":15,"./components/helpers/help":16,"./components/helpers/item-choices":17,"./components/helpers/label":18,"./components/helpers/list-control":19,"./components/helpers/list-item":22,"./components/helpers/list-item-control":20,"./components/helpers/list-item-value":21,"./components/helpers/move-item-back":23,"./components/helpers/move-item-forward":24,"./components/helpers/object-control":25,"./components/helpers/object-item":29,"./components/helpers/object-item-control":26,"./components/helpers/object-item-key":27,"./components/helpers/object-item-value":28,"./components/helpers/remove-item":30,"./components/helpers/select-value":31,"./utils":42}],33:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=e("./utils"),r=e("./default-config"),a=function(e){return e.map(function(e){return e.key}).filter(function(e){return!s.isUndefined(e)})},c=i.createClass({displayName:"FormaticControlled",onChange:function(e,t){if(this.props.onChange){var n=!this.props.field;t=s.extend({},t),n&&(t.fields=t.fields.slice(1),t.field=t.fields[0]),t.path=a(t.fields),this.props.onChange(e,t)}},onAction:function(e){if(this.props.onAction){var t=!this.props.field;e=s.extend({},e),t&&(e.fields=e.fields.slice(1),e.field=e.fields[0]),e.path=a(e.fields),this.props.onAction(e)}},render:function(){var e=this.props.config,t=this.props.field,n=this.props.value;if(!t){var i=this.props.fields;if(!i)throw new Error("Must specify field or fields.");t={type:"fields",plain:!0,fields:i}}if(s.isUndefined(n))throw new Error("You must supply a value to the root Formatic component.");return o.div({className:"formatic"},e.createField({config:e,field:t,value:n,onChange:this.onChange,onAction:this.onAction}))}}),d=i.createFactory(c);t.exports=i.createClass({statics:{createConfig:function(){var e=s.toArray(arguments),t=s.extend({},r);if(0===e.length)return t;var n=[t].concat(e);return n.reduce(function(e,t){return s.isFunction(t)?(t(e),e):s.extend(e,t)})},availableMixins:{clickOutside:e("./mixins/click-outside.js"),field:e("./mixins/field.js"),helper:e("./mixins/helper.js"),inputActions:e("./mixins/input-actions.js"),resize:e("./mixins/resize.js"),scroll:e("./mixins/scroll.js"),undoStack:e("./mixins/undo-stack.js")},plugins:{bootstrap:e("./plugins/bootstrap")},utils:l},displayName:"Formatic",getInitialState:function(){return{isControlled:!s.isUndefined(this.props.value),value:s.isUndefined(this.props.value)?this.props.defaultValue:this.props.value}},componentWillReceiveProps:function(e){this.state.isControlled&&(s.isUndefined(e.value)||this.setState({value:e.value}))},onChange:function(e,t){this.state.isControlled||this.setState({value:e}),this.props.onChange&&this.props.onChange(e,t)},onAction:function(e){this.props.onAction&&this.props.onAction(e);var t=l.dashToPascal(e.action);this.props["on"+t]&&this.props["on"+t](e)},render:function(){var e=this.props.config||r,t=this.state.value;return this.state.isControlled&&(this.props.onChange||console.log("You should supply an onChange handler if you supply a value.")),d({config:e,field:this.props.field,fields:this.props.fields,value:t,onChange:this.onChange,onAction:this.onAction})}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./default-config":32,"./mixins/click-outside.js":34,"./mixins/field.js":35,"./mixins/helper.js":36,"./mixins/input-actions.js":37,"./mixins/resize.js":38,"./mixins/scroll.js":39,"./mixins/undo-stack.js":40,"./plugins/bootstrap":41,"./utils":42}],34:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i=function(e,t){return e.parentNode===t?!0:null===e.parentNode?!1:i(e.parentNode,t)};t.exports={isNodeOutside:function(e,t){return e===t?!1:i(e,t)?!1:!0},isNodeInside:function(e,t){return!this.isNodeOutside(e,t)},_onClickMousedown:function(){n.each(this.clickOutsideHandlers,function(e,t){this.refs[t]&&(this._mousedownRefs[t]=!0)}.bind(this))},_onClickMouseup:function(e){n.each(this.clickOutsideHandlers,function(t,n){this.refs[n]&&this._mousedownRefs[n]&&this.isNodeOutside(e.target,this.refs[n].getDOMNode())&&t.forEach(function(t){t.call(this,e)}.bind(this)),this._mousedownRefs[n]=!1}.bind(this))},setOnClickOutside:function(e,t){this.clickOutsideHandlers[e]||(this.clickOutsideHandlers[e]=[]),this.clickOutsideHandlers[e].push(t)},componentDidMount:function(){this.clickOutsideHandlers={},this._didMouseDown=!1,document.addEventListener("mousedown",this._onClickMousedown),document.addEventListener("mouseup",this._onClickMouseup),this._mousedownRefs={}},componentWillUnmount:function(){this.clickOutsideHandlers={},document.removeEventListener("mouseup",this._onClickMouseup),document.removeEventListener("mousedown",this._onClickMousedown)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports={onChangeValue:function(e){this.props.onChange(e,{field:this.props.field,fields:[this.props.field]})},onBubbleValue:function(e,t){t=n.extend({},t),t.fields=[this.props.field].concat(t.fields),this.props.onChange(e,t)},onStartAction:function(e,t){if(this.props.onAction){var i=n.extend({},t);i.action=e,i.field=this.props.field,i.fields=[this.props.field],this.props.onAction(i)}},onFocusAction:function(){this.onStartAction("focus")},onBlurAction:function(){this.onStartAction("blur")},onBubbleAction:function(e){this.props.onAction&&(e=n.extend({},e),e.field||(e.field=this.props.field,e.fields=[]),e.fields=[this.props.field].concat(e.fields),this.props.onAction(e))},renderWithConfig:function(){return this.props.config.renderFieldComponent(this)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports={renderWithConfig:function(){return this.props.config.renderComponent(this)},onStartAction:function(e,t){if(this.props.onAction){var i=n.extend({},t);i.action=e,this.props.onAction(i)}},onBubbleAction:function(e){this.props.onAction&&this.props.onAction(e)},onFocusAction:function(){this.onStartAction("focus")},onBlurAction:function(){this.onStartAction("blur")}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t){"use strict";t.exports=function(e){e.exports={onFocus:function(){},onBlur:function(){},onChange:function(){}}}},{}],38:[function(e,t){"use strict";var n=0,i={},o=0,s=null,l=function(){Object.keys(i).forEach(function(e){var t=i[e];if(t.clientWidth!==t.__prevClientWidth||t.clientHeight!==t.__prevClientHeight){t.__prevClientWidth=t.clientWidth,t.__prevClientHeight=t.clientHeight;var n=t.__resizeHandlers;n.forEach(function(e){e()})}},100)},r=function(e,t){null===s&&(s=setInterval(l,100)),"__resizeId"in e||(n++,e.__prevClientWidth=e.clientWidth,e.__prevClientHeight=e.clientHeight,e.__resizeId=n,o++,i[n]=e,e.__resizeHandlers=[]),e.__resizeHandlers.push(t)},a=function(e){if("__resizeId"in e){var t=e.__resizeId;delete e.__resizeId,delete e.__resizeHandlers,delete i[t],o--,1>o&&(clearInterval(s),s=null)}},c=function(e,t){t(e)};t.exports={componentDidMount:function(){this.onResizeWindow&&window.addEventListener("resize",this.onResizeWindow),this.resizeElementRefs={}},componentWillUnmount:function(){this.onResizeWindow&&window.removeEventListener("resize",this.onResizeWindow),Object.keys(this.resizeElementRefs).forEach(function(e){a(this.refs[e].getDOMNode())}.bind(this))},setOnResize:function(e,t){this.resizeElementRefs[e]||(this.resizeElementRefs[e]=!0),r(this.refs[e].getDOMNode(),c.bind(this,e,t))}}},{}],39:[function(e,t){"use strict";t.exports=function(e){e.exports={componentDidMount:function(){this.onScrollWindow&&window.addEventListener("scroll",this.onScrollWindow)},componentWillUnmount:function(){this.onScrollWindow&&window.removeEventListener("scroll",this.onScrollWindow)}}}},{}],40:[function(e,t){"use strict";t.exports={getInitialState:function(){return{undo:[],redo:[]}},snapshot:function(){var e=this.state.undo.concat(this.getStateSnapshot());"number"==typeof this.state.undoDepth&&e.length>this.state.undoDepth&&e.shift(),this.setState({undo:e,redo:[]})},hasUndo:function(){return this.state.undo.length>0},hasRedo:function(){return this.state.redo.length>0},redo:function(){this._undoImpl(!0)},undo:function(){this._undoImpl()},_undoImpl:function(e){var t,n=this.state.undo.slice(0),i=this.state.redo.slice(0);if(e){if(0===i.length)return;t=i.pop(),n.push(this.getStateSnapshot())}else{if(0===n.length)return;t=n.pop(),i.push(this.getStateSnapshot())}this.setStateSnapshot(t),this.setState({undo:n,redo:i})}}},{}],41:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i={Field:{classes:{"form-group":!0}},Help:{classes:{"help-block":!0}},Sample:{classes:{"help-block":!0}},ListControl:{classes:{"form-inline":!0}},ListItem:{classes:{well:!0}},ItemChoices:{classes:{"form-control":!0}},AddItem:{classes:{"glyphicon glyphicon-plus":!0},label:""},RemoveItem:{classes:{"glyphicon glyphicon-remove":!0},label:""},MoveItemBack:{classes:{"glyphicon glyphicon-arrow-up":!0},label:""},MoveItemForward:{classes:{"glyphicon glyphicon-arrow-down":!0},label:""},ObjectItemKey:{classes:{"form-control":!0}},Unicode:{classes:{"form-control":!0}},Text:{classes:{"form-control":!0}},PrettyText:{classes:{"form-control":!0}},Json:{classes:{"form-control":!0}},Select:{classes:{"form-control":!0}}};t.exports=function(e){var t=e.createElement;e.createElement=function(o,s,l){o=e.elementName(o);var r=i[o];return r&&(s=n.extend({},s),s.classes=n.extend({},s.classes,r.classes),"label"in r&&(s.label=r.label)),t.call(this,o,s,l)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],42:[function(e,t,n){(function(e){"use strict";var t="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i=n;i.deepCopy=function(e){if(t.isArray(e))return e.map(function(e){return i.deepCopy(e)});if(t.isFunction(e))return e;if(t.isNull(e))return e;if(t.isObject(e)){var n={};return t.each(e,function(e,t){n[t]=i.deepCopy(e)}),n}return e};var o={};i.dashToPascal=function(e){return o[e]||(o[e]=e.split("-").map(function(e){return e[0].toUpperCase()+e.substring(1)}).join("")),o[e]},i.copyElementStyle=function(e,t){var n=window.getComputedStyle(e,"");if(""!==n.cssText)return void(t.style.cssText=n.cssText);for(var i=[],o=0;o<n.length;o++)i.push(n[o]+":"+n.getPropertyValue(n[o])+";");var s=i.join("");t.style.cssText=s};var s={isChrome:!1,isMozilla:!1,isOpera:!1,isIe:!1,isSafari:!1},l=navigator.userAgent;l.indexOf("Chrome")>-1?s.isChrome=!0:l.indexOf("Safari")>-1?s.isSafari=!0:l.indexOf("Opera")>-1?s.isOpera=!0:l.indexOf("Firefox")>-1?s.isMozilla=!0:l.indexOf("MSIE")>-1&&(s.isIe=!0),i.browser=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],formatic:[function(e,t){t.exports=e("./lib/formatic")},{"./lib/formatic":33}]},{},[])("formatic")});