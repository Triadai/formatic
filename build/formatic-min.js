!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Formatic=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";module.exports=require("./lib/formatic")},{"./lib/formatic":36}],2:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;var CSSTransitionGroup=React.createFactory(React.addons.CSSTransitionGroup);module.exports=React.createClass({displayName:"Array",mixins:[require("../../mixins/field")],nextLookupId:0,getInitialState:function getInitialState(){var lookups=[];var items=this.props.field.value;items.forEach(function(item,i){lookups[i]="_"+this.nextLookupId;this.nextLookupId++}.bind(this));return{lookups:lookups}},componentWillReceiveProps:function componentWillReceiveProps(newProps){var lookups=this.state.lookups;var items=newProps.field.value;if(items.length>lookups.length){for(var i=lookups.length;i<items.length;i++){lookups[i]="_"+this.nextLookupId;this.nextLookupId++}}this.setState({lookups:lookups})},onChange:function onChange(i,newValue,info){var newArrayValue=this.props.field.value.slice(0);newArrayValue[i]=newValue;this.onBubbleValue(newArrayValue,info)},onAppend:function onAppend(itemChoiceIndex){var config=this.props.config;var field=this.props.field;var newValue=config.createNewChildFieldValue(field,itemChoiceIndex);var items=field.value;items=items.concat(newValue);this.onChangeValue(items)},onRemove:function onRemove(i){var lookups=this.state.lookups;lookups.splice(i,1);this.setState({lookups:lookups});var newItems=this.props.field.value.slice(0);newItems.splice(i,1);this.onChangeValue(newItems)},onMove:function onMove(fromIndex,toIndex){var lookups=this.state.lookups;var fromId=lookups[fromIndex];var toId=lookups[toIndex];lookups[fromIndex]=toId;lookups[toIndex]=fromId;this.setState({lookups:lookups});var newItems=this.props.field.value.slice(0);if(fromIndex!==toIndex&&fromIndex>=0&&fromIndex<newItems.length&&toIndex>=0&&toIndex<newItems.length){newItems.splice(toIndex,0,newItems.splice(fromIndex,1)[0])}this.onChangeValue(newItems)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var fields=config.createChildFields(field);var numItems=field.value.length;return config.createElement("field",{field:field,plain:this.props.plain},R.div({className:cx(this.props.classes)},CSSTransitionGroup({transitionName:"reveal"},fields.map(function(childField,i){return config.createElement("array-item",{key:this.state.lookups[i],field:childField,index:i,numItems:numItems,onMove:this.onMove,onRemove:this.onRemove,onChange:this.onChange,onAction:this.onBubbleAction})}.bind(this))),config.createElement("array-control",{field:field,onAppend:this.onAppend})))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],3:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;module.exports=React.createClass({displayName:"Boolean",mixins:[require("../../mixins/field")],onChange:function onChange(newValue){this.onChangeValue(newValue)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var choices=config.fieldBooleanChoices(field);return config.createElement("field",{field:field,plain:this.props.plain},config.createElement("select-value",{choices:choices,field:field,onChange:this.onChange,onAction:this.onBubbleAction}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],4:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"CheckboxArray",mixins:[require("../../mixins/field")],getInitialState:function getInitialState(){return{choices:this.props.config.fieldChoices(this.props.field)}},componentWillReceiveProps:function componentWillReceiveProps(newProps){this.setState({choices:newProps.config.fieldChoices(newProps.field)})},onChange:function onChange(){var choiceNodes=this.refs.choices.getDOMNode().getElementsByTagName("input");choiceNodes=Array.prototype.slice.call(choiceNodes,0);var values=choiceNodes.map(function(node){return node.checked?node.value:null}).filter(function(value){return value});this.onChangeValue(values)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var choices=this.state.choices||[];var isInline=!_.find(choices,function(choice){return choice.sample});return config.createElement("field",{field:field},R.div({className:cx(this.props.classes),ref:"choices"},choices.map(function(choice,i){var inputField=R.span({style:{whiteSpace:"nowrap"}},R.input({name:field.key,type:"checkbox",value:choice.value,checked:field.value.indexOf(choice.value)>=0?true:false,onChange:this.onChange,onFocus:this.onFocusAction,onBlur:this.onBlurAction})," ",R.span({className:"field-choice-label"},choice.label));if(isInline){return R.span({key:i,className:"field-choice"},inputField," ")}else{return R.div({key:i,className:"field-choice"},inputField," ",config.createElement("sample",{field:field,choice:choice}))}}.bind(this))))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],5:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"CheckboxBoolean",mixins:[require("../../mixins/field")],onChange:function onChange(event){this.onChangeValue(event.target.checked)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return config.createElement("field",{config:config,field:field,plain:true},R.span({style:{whiteSpace:"nowrap"}},R.input({type:"checkbox",checked:field.value,className:cx(this.props.classes),onChange:this.onChange,onFocus:this.onFocusAction,onBlur:this.onBlurAction}),R.span({}," "),R.span({},config.fieldHelpText(field)||config.fieldLabel(field))))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],6:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"Copy",mixins:[require("../../mixins/field")],render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){return R.div({className:cx(this.props.classes)},this.props.config.fieldHelpText(this.props.field))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],7:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"Fields",mixins:[require("../../mixins/field")],onChangeField:function onChangeField(key,newValue,info){if(key){var newObjectValue=_.extend({},this.props.field.value);newObjectValue[key]=newValue;this.onBubbleValue(newObjectValue,info)}},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var fields=config.createChildFields(field);return config.createElement("field",{config:config,field:field,plain:this.props.plain},R.fieldset({className:cx(this.props.classes)},fields.map(function(childField,i){var key=childField.key||i;return config.createFieldElement({key:key||i,field:childField,onChange:this.onChangeField.bind(this,key),onAction:this.onBubbleAction})}.bind(this))))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],8:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"Json",mixins:[require("../../mixins/field")],getDefaultProps:function getDefaultProps(){return{rows:5}},isValidValue:function isValidValue(value){try{JSON.parse(value);return true}catch(e){return false}},getInitialState:function getInitialState(){return{isValid:true,value:JSON.stringify(this.props.field.value,null,2)}},onChange:function onChange(event){var isValid=this.isValidValue(event.target.value);if(isValid){this._isChanging=true;this.onChangeValue(JSON.parse(event.target.value))}this.setState({isValid:isValid,value:event.target.value})},componentWillReceiveProps:function componentWillReceiveProps(nextProps){if(!this._isChanging){this.setState({isValid:true,value:JSON.stringify(nextProps.field.value,null,2)})}this._isChanging=false},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return config.createElement("field",{field:config.fieldWithValue(field,this.state.value),plain:this.props.plain},R.textarea({className:cx(this.props.classes),value:this.state.value,onChange:this.onChange,style:{backgroundColor:this.state.isValid?"":"rgb(255,200,200)"},rows:config.fieldRows(field)||this.props.rows,onFocus:this.onFocusAction,onBlur:this.onBlurAction}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],9:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var cx=React.addons.classSet;var CSSTransitionGroup=React.createFactory(React.addons.CSSTransitionGroup);var tempKeyPrefix="$$__temp__";var tempKey=function tempKey(id){return tempKeyPrefix+id};var isTempKey=function isTempKey(key){return key.substring(0,tempKeyPrefix.length)===tempKeyPrefix};module.exports=React.createClass({displayName:"Object",mixins:[require("../../mixins/field")],nextLookupId:0,getInitialState:function getInitialState(){var keyToId={};var keys=Object.keys(this.props.field.value);var keyOrder=[];var tempDisplayKeys={};keys.forEach(function(key){var id=++this.nextLookupId;keyToId[key]=id;keyOrder.push(key);if(isTempKey(key)){tempDisplayKeys[id]=""}}.bind(this));return{keyToId:keyToId,keyOrder:keyOrder,tempDisplayKeys:tempDisplayKeys}},componentWillReceiveProps:function componentWillReceiveProps(newProps){var keyToId=this.state.keyToId;var newKeyToId={};var tempDisplayKeys=this.state.tempDisplayKeys;var newTempDisplayKeys={};var keyOrder=this.state.keyOrder;var keys=Object.keys(newProps.field.value);var addedKeys=[];keys.forEach(function(key){if(!keyToId[key]){this.nextLookupId++;newKeyToId[key]=this.nextLookupId;addedKeys.push(key)}else{newKeyToId[key]=keyToId[key]}if(isTempKey(key)&&newKeyToId[key]in tempDisplayKeys){newTempDisplayKeys[newKeyToId[key]]=tempDisplayKeys[newKeyToId[key]]}}.bind(this));var newKeyOrder=[];keyOrder.forEach(function(key){if(newKeyToId[key]){newKeyOrder.push(key)}});newKeyOrder=newKeyOrder.concat(addedKeys);this.setState({keyToId:newKeyToId,keyOrder:newKeyOrder,tempDisplayKeys:newTempDisplayKeys})},onChange:function onChange(key,newValue,info){var newObj=_.extend({},this.props.field.value);newObj[key]=newValue;this.onBubbleValue(newObj,info)},onAppend:function onAppend(itemChoiceIndex){var config=this.props.config;var field=this.props.field;this.nextLookupId++;var keyToId=this.state.keyToId;var keyOrder=this.state.keyOrder;var tempDisplayKeys=this.state.tempDisplayKeys;var id=this.nextLookupId;var newKey=tempKey(id);keyToId[newKey]=id;tempDisplayKeys[id]="";keyOrder.push(newKey);this.setState({keyToId:keyToId,tempDisplayKeys:tempDisplayKeys,keyOrder:keyOrder});var newObj=_.extend(this.props.field.value);var newValue=config.createNewChildFieldValue(field,itemChoiceIndex);newObj[newKey]=newValue;this.onChangeValue(newObj)},onRemove:function onRemove(key){var newObj=_.extend(this.props.field.value);delete newObj[key];this.onChangeValue(newObj)},onMove:function onMove(fromKey,toKey){if(fromKey!==toKey){var keyToId=this.state.keyToId;var keyOrder=this.state.keyOrder;var tempDisplayKeys=this.state.tempDisplayKeys;var newObj=_.extend(this.props.field.value);if(keyToId[toKey]){var tempToKey=tempKey(keyToId[toKey]);tempDisplayKeys[keyToId[toKey]]=toKey;keyToId[tempToKey]=keyToId[toKey];keyOrder[keyOrder.indexOf(toKey)]=tempToKey;delete keyToId[toKey];this.setState({keyToId:keyToId,tempDisplayKeys:tempDisplayKeys,keyOrder:keyOrder});newObj[tempToKey]=newObj[toKey];delete newObj[toKey]}if(!toKey){toKey=tempKey(keyToId[fromKey]);tempDisplayKeys[keyToId[fromKey]]=""}keyToId[toKey]=keyToId[fromKey];delete keyToId[fromKey];keyOrder[keyOrder.indexOf(fromKey)]=toKey;this.setState({keyToId:keyToId,keyOrder:keyOrder,tempDisplayKeys:tempDisplayKeys});newObj[toKey]=newObj[fromKey];delete newObj[fromKey];this.onChangeValue(newObj);if(fromKey&&fromKey!==toKey){if(!(fromKey in newObj)){Object.keys(newObj).forEach(function(key){if(!isTempKey(key)){return}var id=keyToId[key];var displayKey=tempDisplayKeys[id];if(fromKey===displayKey){this.onMove(key,displayKey)}}.bind(this))}}}},getFields:function getFields(){var config=this.props.config;var field=this.props.field;var fields=config.createChildFields(field);var keyToField={};_.each(fields,function(childField){keyToField[childField.key]=childField});return this.state.keyOrder.map(function(key){return keyToField[key]})},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var fields=this.getFields();return config.createElement("field",{field:field,plain:this.props.plain},R.div({className:cx(this.props.classes)},CSSTransitionGroup({transitionName:"reveal"},fields.map(function(childField){var displayKey=this.state.tempDisplayKeys[this.state.keyToId[childField.key]];if(_.isUndefined(displayKey)){displayKey=childField.key}return config.createElement("object-item",{key:this.state.keyToId[childField.key],field:childField,onMove:this.onMove,onRemove:this.onRemove,onChange:this.onChange,onAction:this.onBubbleAction,displayKey:displayKey,itemKey:childField.key})}.bind(this))),config.createElement("object-control",{field:field,onAppend:this.onAppend})))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],10:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var cx=React.addons.classSet;var utils=require("../../utils");var noBreak=function noBreak(value){return value.replace(/ /g," ")};var LEFT_PAD="  ";var RIGHT_PAD="  ";var idPrefixRegEx=/^[0-9]+__/;var removeIdPrefix=function removeIdPrefix(key){if(idPrefixRegEx.test(key)){return key.replace(idPrefixRegEx,"")}return key};var positionInNode=function positionInNode(position,node){var rect=node.getBoundingClientRect();if(position.x>=rect.left&&position.x<=rect.right){if(position.y>=rect.top&&position.y<=rect.bottom){return true}}};var textPart=function textPart(value,type){type=type||"text";return{type:type,value:value}};var parseTextWithTags=function parseTextWithTags(value){value=value||"";var parts=value.split(/{{(?!{)/);var frontPart=[];if(parts[0]!==""){frontPart=[textPart(parts[0])]}parts=frontPart.concat(parts.slice(1).map(function(part){if(part.indexOf("}}")>=0){return[textPart(part.substring(0,part.indexOf("}}")),"tag"),textPart(part.substring(part.indexOf("}}")+2))]}else{return textPart("{{"+part,"text")}}));return[].concat.apply([],parts)};module.exports=React.createClass({displayName:"TaggedText",mixins:[require("../../mixins/field"),require("../../mixins/undo-stack"),require("../../mixins/resize")],getReplaceState:function getReplaceState(props){var replaceChoices=props.config.fieldReplaceChoices(props.field);var replaceChoicesLabels={};replaceChoices.forEach(function(choice){replaceChoicesLabels[choice.value]=choice.label});return{replaceChoices:replaceChoices,replaceChoicesLabels:replaceChoicesLabels}},getInitialState:function getInitialState(){var replaceState=this.getReplaceState(this.props);return{undoDepth:100,isChoicesOpen:false,hoverPillRef:null,replaceChoices:replaceState.replaceChoices,replaceChoicesLabels:replaceState.replaceChoicesLabels}},componentWillReceiveProps:function componentWillReceiveProps(newProps){this.setState(this.getReplaceState(newProps))},componentWillMount:function componentWillMount(){this.tracking={};var parts=parseTextWithTags(this.props.field.value);var tokens=this.tokens(parts);var indexMap=this.indexMap(tokens);this.tracking.pos=indexMap.length;this.tracking.range=0;this.tracking.tokens=tokens;this.tracking.indexMap=indexMap},getStateSnapshot:function getStateSnapshot(){return{value:this.props.field.value,pos:this.tracking.pos,range:this.tracking.range}},setStateSnapshot:function setStateSnapshot(snapshot){this.tracking.pos=snapshot.pos;this.tracking.range=snapshot.range;this.onChangeValue(snapshot.value)},tokens:function tokens(parts){return[].concat.apply([],parts.map(function(part){if(part.type==="tag"){return part}else{return part.value.split("")}}))},indexMap:function(_indexMap){var _indexMapWrapper=function indexMap(_x){return _indexMap.apply(this,arguments)};_indexMapWrapper.toString=function(){return _indexMap.toString()};return _indexMapWrapper}(function(tokens){var indexMap=[];_.each(tokens,function(token,tokenIndex){if(token.type==="tag"){var label=LEFT_PAD+noBreak(this.prettyLabel(token.value))+RIGHT_PAD;var labelChars=label.split("");_.each(labelChars,function(){indexMap.push(tokenIndex)})}else{indexMap.push(tokenIndex)}}.bind(this));return indexMap}),onScroll:function onScroll(){this.refs.highlight.getDOMNode().scrollTop=this.refs.content.getDOMNode().scrollTop;this.refs.highlight.getDOMNode().scrollLeft=this.refs.content.getDOMNode().scrollLeft},tokenIndex:function tokenIndex(pos,tokens,indexMap){if(pos<0){pos=0}else if(pos>=indexMap.length){return tokens.length}return indexMap[pos]},onChange:function onChange(event){var node=event.target;var prevPos=this.tracking.pos;var prevRange=this.tracking.range;var pos=node.selectionStart;var tokens=this.tracking.tokens;var prevTokenIndex=this.tokenIndex(prevPos,tokens,this.tracking.indexMap);var prevTokenEndIndex=this.tokenIndex(prevPos+prevRange,tokens,this.tracking.indexMap);var prevTokenRange=prevTokenEndIndex-prevTokenIndex;if(prevTokenRange>0){tokens.splice(prevTokenIndex,prevTokenRange);this.tracking.indexMap=this.indexMap(tokens)}if(pos>prevPos){var addedText=node.value.substring(prevPos,pos);tokens.splice(prevTokenIndex,0,addedText)}if(pos<prevPos){var token=this.tokenAt(pos);var tokenBefore=this.tokenBefore(pos);if(token===tokenBefore){pos=this.moveOffTag(pos,tokens,this.indexMap(tokens),-1)}var tokenIndex=this.tokenIndex(pos,tokens,this.tracking.indexMap);tokens.splice(tokenIndex,prevTokenIndex-tokenIndex)}var rawValue=this.rawValue(tokens);this.tracking.pos=pos;this.tracking.range=0;this.onChangeValue(rawValue);this.snapshot()},componentDidUpdate:function componentDidUpdate(){var value=this.props.field.value||"";var parts=parseTextWithTags(value);this.tracking.tokens=this.tokens(parts);this.tracking.indexMap=this.indexMap(this.tracking.tokens);var pos=this.normalizePosition(this.tracking.pos);var range=this.tracking.range;var endPos=this.normalizePosition(pos+range);range=endPos-pos;this.tracking.pos=pos;this.tracking.range=range;if(document.activeElement===this.refs.content.getDOMNode()){this.refs.content.getDOMNode().setSelectionRange(pos,pos+range)}},prettyLabel:function prettyLabel(key){if(this.state.replaceChoicesLabels[key]){return this.state.replaceChoicesLabels[key]}var cleaned=removeIdPrefix(key);return this.props.config.humanize(cleaned)},plainValue:function plainValue(value){var parts=parseTextWithTags(value);return parts.map(function(part){if(part.type==="text"){return part.value}else{return LEFT_PAD+noBreak(this.prettyLabel(part.value))+RIGHT_PAD}}.bind(this)).join("")},prettyValue:function prettyValue(value){var parts=parseTextWithTags(value);return parts.map(function(part,i){if(part.type==="text"){if(i===parts.length-1){if(part.value[part.value.length-1]==="\n"){return part.value+" "}}return part.value}else{var pillRef="prettyPart"+i;var className="pretty-part";if(this.state.hoverPillRef&&pillRef===this.state.hoverPillRef){className+=" pretty-part-hover"}return R.span({key:i,className:className,ref:pillRef,"data-pretty":true,"data-ref":pillRef},R.span({className:"pretty-part-left"},LEFT_PAD),R.span({className:"pretty-part-text"},noBreak(this.prettyLabel(part.value))),R.span({className:"pretty-part-right"},RIGHT_PAD))}}.bind(this))},rawValue:function rawValue(tokens){return tokens.map(function(token){if(token.type==="tag"){return"{{"+token.value+"}}"}else{return token}}).join("")},moveOffTag:function moveOffTag(pos,tokens,indexMap,dir){if(typeof dir==="undefined"||dir>0){dir=1}else{dir=-1}var token;if(dir>0){token=tokens[indexMap[pos]];while(pos<indexMap.length&&tokens[indexMap[pos]].type==="tag"&&tokens[indexMap[pos]]===token){pos++}}else{token=tokens[indexMap[pos-1]];while(pos>0&&tokens[indexMap[pos-1]].type==="tag"&&tokens[indexMap[pos-1]]===token){pos--}}return pos},tokenAt:function tokenAt(pos){if(pos>=this.tracking.indexMap.length){return null}if(pos<0){pos=0}return this.tracking.tokens[this.tracking.indexMap[pos]]},tokenBefore:function tokenBefore(pos){if(pos>=this.tracking.indexMap.length){pos=this.tracking.indexMap.length}if(pos<=0){return null}return this.tracking.tokens[this.tracking.indexMap[pos-1]]},normalizePosition:function normalizePosition(pos,prevPos){if(_.isUndefined(prevPos)){prevPos=pos}if(pos<=0||pos>=this.tracking.indexMap.length){if(pos<0){pos=0}if(pos>this.tracking.indexMap.length){pos=this.tracking.indexMap.length}return pos}var token=this.tokenAt(pos);var tokenBefore=this.tokenBefore(pos);if(token!==tokenBefore){return pos}var prevToken=this.tokenAt(prevPos);var prevTokenBefore=this.tokenBefore(prevPos);var rightPos=this.moveOffTag(pos,this.tracking.tokens,this.tracking.indexMap);var leftPos=this.moveOffTag(pos,this.tracking.tokens,this.tracking.indexMap,-1);if(prevToken!==prevTokenBefore){if(prevToken===token){return rightPos}if(prevTokenBefore===token){return leftPos}}var newPos=rightPos;if(pos===prevPos||pos<prevPos){if(rightPos-pos>pos-leftPos){newPos=leftPos}}return newPos},onSelect:function onSelect(event){var node=event.target;var pos=node.selectionStart;var endPos=node.selectionEnd;if(pos===endPos&&this.state.hoverPillRef){var tokenAt=this.tokenAt(pos);var tokenBefore=this.tokenBefore(pos);if(tokenAt&&tokenAt===tokenBefore&&tokenAt.type&&tokenAt.type==="tag"){var rightPos=this.moveOffTag(pos,this.tracking.tokens,this.tracking.indexMap);var leftPos=this.moveOffTag(pos,this.tracking.tokens,this.tracking.indexMap,-1);this.tracking.pos=leftPos;this.tracking.range=rightPos-leftPos;node.selectionStart=leftPos;node.selectionEnd=rightPos;if(!this.state.isChoicesOpen){this.setChoicesOpen(true)}return}}pos=this.normalizePosition(pos,this.tracking.pos);endPos=this.normalizePosition(endPos,this.tracking.pos+this.tracking.range);this.tracking.pos=pos;this.tracking.range=endPos-pos;node.selectionStart=pos;node.selectionEnd=endPos},onCopy:function onCopy(){var node=this.refs.content.getDOMNode();var start=node.selectionStart;var end=node.selectionEnd;var text=node.value.substring(start,end);var realStartIndex=this.tokenIndex(start,this.tracking.tokens,this.tracking.indexMap);var realEndIndex=this.tokenIndex(end,this.tracking.tokens,this.tracking.indexMap);var tokens=this.tracking.tokens.slice(realStartIndex,realEndIndex);text=this.rawValue(tokens);var originalValue=node.value;node.value=node.value+text;node.setSelectionRange(originalValue.length,originalValue.length+text.length);window.setTimeout(function(){node.value=originalValue;node.setSelectionRange(start,end)},0)},onCut:function onCut(){var node=this.refs.content.getDOMNode();var start=node.selectionStart;var end=node.selectionEnd;var text=node.value.substring(start,end);var realStartIndex=this.tokenIndex(start,this.tracking.tokens,this.tracking.indexMap);var realEndIndex=this.tokenIndex(end,this.tracking.tokens,this.tracking.indexMap);var tokens=this.tracking.tokens.slice(realStartIndex,realEndIndex);text=this.rawValue(tokens);var originalValue=node.value;var cutValue=node.value.substring(0,start)+node.value.substring(end);node.value=node.value+text;node.setSelectionRange(originalValue.length,originalValue.length+text.length);var cutTokens=this.tracking.tokens.slice(0,realStartIndex).concat(this.tracking.tokens.slice(realEndIndex));window.setTimeout(function(){node.value=cutValue;node.setSelectionRange(start,start);this.tracking.pos=start;this.tracking.range=0;this.tracking.tokens=cutTokens;this.tracking.indexMap=this.indexMap(this.tracking.tokens);var rawValue=this.rawValue(this.tracking.tokens);this.onChangeValue(rawValue);this.snapshot()}.bind(this),0)},onKeyDown:function onKeyDown(event){if(event.keyCode===37){this.leftArrowDown=true}else if(event.keyCode===39){this.rightArrowDown=true}if(event.keyCode===90&&(event.metaKey||event.ctrlKey)&&!event.shiftKey){event.preventDefault();this.undo()}else if(event.keyCode===89&&event.ctrlKey&&!event.shiftKey||event.keyCode===90&&event.metaKey&&event.shiftKey){this.redo()}},onKeyUp:function onKeyUp(event){if(event.keyCode===37){this.leftArrowDown=false}else if(event.keyCode===39){this.rightArrowDown=false}},adjustStyles:function adjustStyles(isMount){var overlay=this.refs.highlight.getDOMNode();var content=this.refs.content.getDOMNode();var style=window.getComputedStyle(content);var backgroundColor=style.backgroundColor;utils.copyElementStyle(content,overlay);overlay.style.position="absolute";overlay.style.whiteSpace="pre-wrap";overlay.style.color="rgba(0,0,0,0)";overlay.style.webkitTextFillColor="rgba(0,0,0,0)";overlay.style.resize="none";overlay.style.borderColor="rgba(0,0,0,0)";if(utils.browser.isMozilla){var paddingTop=parseFloat(style.paddingTop);var paddingBottom=parseFloat(style.paddingBottom);var borderTop=parseFloat(style.borderTopWidth);var borderBottom=parseFloat(style.borderBottomWidth);overlay.style.paddingTop="0px";overlay.style.paddingBottom="0px";overlay.style.height=content.clientHeight-paddingTop-paddingBottom+borderTop+borderBottom+"px";overlay.style.top=style.paddingTop;overlay.style.boxShadow="none"}if(isMount){this.backgroundColor=backgroundColor}overlay.style.backgroundColor=this.backgroundColor;content.style.backgroundColor="rgba(0,0,0,0)"},onResize:function onResize(){this.adjustStyles()},onResizeWindow:function onResizeWindow(){this.adjustStyles()},componentDidMount:function componentDidMount(){this.adjustStyles(true);this.setOnResize("content",this.onResize)},onInsertFromSelect:function onInsertFromSelect(event){if(event.target.selectedIndex>0){var tag=event.target.value;event.target.selectedIndex=0;var pos=this.tracking.pos;var insertPos=this.normalizePosition(pos);var tokens=this.tracking.tokens;var tokenIndex=this.tokenIndex(insertPos,tokens,this.tracking.indexMap);tokens.splice(tokenIndex,0,{type:"tag",value:tag});this.tracking.indexMap=this.indexMap(tokens);var newValue=this.rawValue(tokens);this.tracking.pos+=this.prettyLabel(tag).length;this.onChangeValue(newValue);this.refs.content.getDOMNode().focus()}},onInsert:function onInsert(value){var tag=value;var pos=this.tracking.pos;var endPos=this.tracking.pos+this.tracking.range;var insertPos=this.normalizePosition(pos);var endInsertPos=this.normalizePosition(endPos);var tokens=this.tracking.tokens;var tokenIndex=this.tokenIndex(insertPos,tokens,this.tracking.indexMap);var tokenEndIndex=this.tokenIndex(endInsertPos,tokens,this.tracking.indexMap);tokens.splice(tokenIndex,tokenEndIndex-tokenIndex,{type:"tag",value:tag});this.tracking.indexMap=this.indexMap(tokens);var newValue=this.rawValue(tokens);this.tracking.pos+=this.prettyLabel(tag).length;this.onChangeValue(newValue);this.setState({isChoicesOpen:false});this.refs.content.getDOMNode().focus()},onToggleChoices:function onToggleChoices(){this.setChoicesOpen(!this.state.isChoicesOpen)},onCloseChoices:function onCloseChoices(){if(this.state.isChoicesOpen){this.setChoicesOpen(false)}},setChoicesOpen:function setChoicesOpen(isOpen){if(isOpen){this.onStartAction("open-replacements")}else{this.onStartAction("close-replacements")}this.setState({isChoicesOpen:isOpen})},closeChoices:function closeChoices(){},getCloseIgnoreNodes:function getCloseIgnoreNodes(){return this.refs.toggle.getDOMNode()},onClickOutsideChoices:function onClickOutsideChoices(){},onMouseMove:function onMouseMove(event){var position={x:event.clientX,y:event.clientY};var nodes=this.refs.highlight.getDOMNode().childNodes;var matchedNode=null;for(var i=0;i<nodes.length;i++){var node=nodes[i];if(nodes[i].getAttribute("data-pretty")){if(positionInNode(position,node)){matchedNode=node;break}}}if(matchedNode){if(this.state.hoverPillRef!==matchedNode.getAttribute("data-ref")){this.setState({hoverPillRef:matchedNode.getAttribute("data-ref")})}}else if(this.state.hoverPillRef){this.setState({hoverPillRef:null})}},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var replaceChoices=this.state.replaceChoices;return config.createElement("field",{field:field,plain:this.props.plain},R.div({style:{position:"relative"}},R.pre({className:"pretty-highlight",ref:"highlight"},this.prettyValue(this.props.field.value)),(config.fieldIsSingleLine(field)?R.input:R.textarea)({type:"text",className:cx(_.extend({},this.props.classes,{"pretty-content":true})),ref:"content",rows:field.rows||this.props.rows,name:field.key,value:this.plainValue(this.props.field.value),onChange:this.onChange,onScroll:this.onScroll,style:{position:"relative",top:0,left:0,cursor:this.state.hoverPillRef?"pointer":null},onKeyPress:this.onKeyPress,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onSelect:this.onSelect,onCopy:this.onCopy,onCut:this.onCut,onMouseMove:this.onMouseMove,onFocus:this.onFocusAction,onBlur:this.onBlurAction}),R.a({ref:"toggle",href:"JavaScript"+":",onClick:this.onToggleChoices},"Insert..."),config.createElement("choices",{ref:"choices",choices:replaceChoices,open:this.state.isChoicesOpen,onSelect:this.onInsert,onClose:this.onCloseChoices,ignoreCloseNodes:this.getCloseIgnoreNodes})))
}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38,"../../mixins/resize":40,"../../mixins/undo-stack":42,"../../utils":47}],11:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;module.exports=React.createClass({displayName:"Select",mixins:[require("../../mixins/field")],getInitialState:function getInitialState(){return{choices:this.props.config.fieldChoices(this.props.field)}},componentWillReceiveProps:function componentWillReceiveProps(newProps){this.setState({choices:newProps.config.fieldChoices(newProps.field)})},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return config.createElement("field",{config:config,field:field,plain:this.props.plain},config.createElement("select-value",{choices:this.state.choices,field:field,onChange:this.onChangeValue,onAction:this.onBubbleAction}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],12:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"SingleLineString",mixins:[require("../../mixins/field")],onChange:function onChange(event){this.onChangeValue(event.target.value)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return config.createElement("field",{config:config,field:field,plain:this.props.plain},R.input({type:"text",value:this.props.field.value,className:cx(this.props.classes),onChange:this.onChange,onFocus:this.onFocusAction,onBlur:this.onBlurAction}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],13:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"String",mixins:[require("../../mixins/field")],onChange:function onChange(event){this.onChangeValue(event.target.value)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return config.createElement("field",{config:config,field:field,plain:this.props.plain},R.textarea({value:field.value,className:cx(this.props.classes),rows:field.rows||this.props.rows,onChange:this.onChange,onFocus:this.onFocusAction,onBlur:this.onBlurAction}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],14:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;module.exports=React.createClass({displayName:"Unknown",mixins:[require("../../mixins/field")],render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){return R.div({},R.div({},"Component not found for: "),R.pre({},JSON.stringify(this.props.field.rawFieldTemplate,null,2)))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/field":38}],15:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"AddItem",mixins:[require("../../mixins/helper")],getDefaultProps:function getDefaultProps(){return{label:"[add]"}},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){return R.span({className:cx(this.props.classes),onClick:this.props.onClick},this.props.label)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],16:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"ArrayControl",mixins:[require("../../mixins/helper")],getInitialState:function getInitialState(){return{fieldTemplateIndex:0}},onSelect:function onSelect(index){this.setState({fieldTemplateIndex:index})},onAppend:function onAppend(){this.props.onAppend(this.state.fieldTemplateIndex)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var fieldTemplates=config.fieldItemFieldTemplates(field);var typeChoices=null;if(fieldTemplates.length>0){typeChoices=config.createElement("field-template-choices",{field:field,fieldTemplateIndex:this.state.fieldTemplateIndex,onSelect:this.onSelect})}return R.div({className:cx(this.props.classes)},typeChoices," ",config.createElement("add-item",{field:field,onClick:this.onAppend}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],17:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"ArrayItemControl",mixins:[require("../../mixins/helper")],onMoveBack:function onMoveBack(){this.props.onMove(this.props.index,this.props.index-1)},onMoveForward:function onMoveForward(){this.props.onMove(this.props.index,this.props.index+1)},onRemove:function onRemove(){this.props.onRemove(this.props.index)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return R.div({className:cx(this.props.classes)},config.createElement("remove-item",{field:field,onClick:this.onRemove,onMaybeRemove:this.props.onMaybeRemove}),this.props.index>0?config.createElement("move-item-back",{field:field,onClick:this.onMoveBack}):null,this.props.index<this.props.numItems-1?config.createElement("move-item-forward",{field:field,onClick:this.onMoveForward}):null)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],18:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"ArrayItemValue",mixins:[require("../../mixins/helper")],onChangeField:function onChangeField(newValue,info){this.props.onChange(this.props.index,newValue,info)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return R.div({className:cx(this.props.classes)},config.createFieldElement({field:field,onChange:this.onChangeField,onAction:this.onBubbleAction}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],19:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;module.exports=React.createClass({displayName:"ArrayItem",mixins:[require("../../mixins/helper")],getInitialState:function getInitialState(){return{isMaybeRemoving:false}},render:function render(){return this.renderWithConfig()},onMaybeRemove:function onMaybeRemove(isMaybeRemoving){this.setState({isMaybeRemoving:isMaybeRemoving})},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var classes=_.extend({},this.props.classes);if(this.state.isMaybeRemoving){classes["maybe-removing"]=true}return R.div({className:cx(classes)},config.createElement("array-item-value",{field:field,index:this.props.index,onChange:this.props.onChange,onAction:this.onBubbleAction}),config.createElement("array-item-control",{field:field,index:this.props.index,numItems:this.props.numItems,onMove:this.props.onMove,onRemove:this.props.onRemove,onMaybeRemove:this.onMaybeRemove}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],20:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var CSSTransitionGroup=React.createFactory(React.addons.CSSTransitionGroup);module.exports=React.createClass({displayName:"Choices",mixins:[require("../../mixins/helper"),require("../../mixins/click-outside")],getInitialState:function getInitialState(){return{maxHeight:null,open:this.props.open}},getIgnoreCloseNodes:function getIgnoreCloseNodes(){if(!this.props.ignoreCloseNodes){return[]}var nodes=this.props.ignoreCloseNodes();if(!_.isArray(nodes)){nodes=[nodes]}return nodes},componentDidMount:function componentDidMount(){this.setOnClickOutside("choices",function(event){if(!_.find(this.getIgnoreCloseNodes(),function(node){return this.isNodeInside(event.target,node)}.bind(this))){this.props.onClose()}}.bind(this));this.adjustSize()},onSelect:function onSelect(choice){this.props.onSelect(choice.value)},onResizeWindow:function onResizeWindow(){this.adjustSize()},onScrollWindow:function onScrollWindow(){this.adjustSize()},adjustSize:function adjustSize(){if(this.refs.choices){var node=this.refs.choices.getDOMNode();var rect=node.getBoundingClientRect();var top=rect.top;var windowHeight=window.innerHeight;var height=windowHeight-top;this.setState({maxHeight:height})}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.setState({open:nextProps.open},function(){this.adjustSize()}.bind(this))},onScroll:function onScroll(){},onWheel:function onWheel(){},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var choices=this.props.choices;if(choices&&choices.length===0){choices=[{value:"///empty///"}]}return R.div({ref:"container",onWheel:this.onWheel,onScroll:this.onScroll,className:"choices-container",style:{userSelect:"none",WebkitUserSelect:"none",position:"absolute",maxHeight:this.state.maxHeight?this.state.maxHeight:null}},CSSTransitionGroup({transitionName:"reveal"},this.props.open?R.ul({ref:"choices",className:"choices"},choices.map(function(choice,i){var choiceElement=null;if(choice.value==="///loading///"){choiceElement=R.a({href:"JavaScript"+":",onClick:this.props.onClose},R.span({className:"choice-label"},"Loading..."))}else if(choice.value==="///empty///"){choiceElement=R.a({href:"JavaScript"+":",onClick:this.props.onClose},R.span({className:"choice-label"},"No choices available."))}else{choiceElement=R.a({href:"JavaScript"+":",onClick:this.onSelect.bind(this,choice)},R.span({className:"choice-label"},choice.label),R.span({className:"choice-sample"},choice.sample))}return R.li({key:i,className:"choice"},choiceElement)}.bind(this))):null))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/click-outside":37,"../../mixins/helper":39}],21:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"FieldTemplateChoices",mixins:[require("../../mixins/helper")],onChange:function onChange(event){this.props.onSelect(parseInt(event.target.value))},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var fieldTemplates=config.fieldItemFieldTemplates(field);var typeChoices=null;if(fieldTemplates.length>1){typeChoices=R.select({className:cx(this.props.classes),value:this.fieldTemplateIndex,onChange:this.onChange},fieldTemplates.map(function(fieldTemplate,i){return R.option({key:i,value:i},fieldTemplate.label||i)}))}return typeChoices?typeChoices:R.span(null)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],22:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var cx=React.addons.classSet;var CSSTransitionGroup=React.createFactory(React.addons.CSSTransitionGroup);module.exports=React.createClass({displayName:"Field",mixins:[require("../../mixins/helper")],getInitialState:function getInitialState(){return{collapsed:this.props.config.fieldIsCollapsed(this.props.field)?true:false}},onClickLabel:function onClickLabel(){this.setState({collapsed:!this.state.collapsed})},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;if(this.props.plain){return this.props.children}var field=this.props.field;var index=this.props.index;if(!_.isNumber(index)){var key=this.props.field.key;index=_.isNumber(key)?key:undefined}var classes=_.extend({},this.props.classes);if(config.fieldIsRequired(field)){classes.required=true;if(_.isUndefined(this.props.field.value)||this.props.field.value===""){classes["validation-error-required"]=true}}else{classes.optional=true}return R.div({className:cx(classes),style:{display:field.hidden?"none":""}},config.createElement("label",{config:config,field:field,index:index,onClick:config.fieldIsCollapsible(field)?this.onClickLabel:null}),CSSTransitionGroup({transitionName:"reveal"},this.state.collapsed?[]:[config.createElement("help",{config:config,field:field,key:"help"}),this.props.children]))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],23:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"Help",mixins:[require("../../mixins/helper")],render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var helpText=this.props.config.fieldHelpText(this.props.field);return helpText?R.div({className:cx(this.props.classes),dangerouslySetInnerHTML:{__html:helpText}}):R.span(null)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],24:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"Label",mixins:[require("../../mixins/helper")],render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var fieldLabel=config.fieldLabel(field);var label=null;if(typeof this.props.index==="number"){label=""+(this.props.index+1)+".";if(fieldLabel){label=label+" "+fieldLabel}}if(fieldLabel||label){var text=label||fieldLabel;if(this.props.onClick){text=R.a({href:"JavaScript"+":",onClick:this.props.onClick},text)}label=R.label({},text)}var requiredOrNot;if(!config.fieldHasValueChildren(field)){requiredOrNot=R.span({className:config.fieldIsRequired(field)?"required-text":"not-required-text"})}return R.div({className:cx(this.props.classes)},label," ",requiredOrNot)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],25:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"MoveItemBack",mixins:[require("../../mixins/helper")],getDefaultProps:function getDefaultProps(){return{label:"[up]"}},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){return R.span({className:cx(this.props.classes),onClick:this.props.onClick},this.props.label)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],26:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"MoveItemForward",mixins:[require("../../mixins/helper")],getDefaultProps:function getDefaultProps(){return{label:"[down]"}},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){return R.span({className:cx(this.props.classes),onClick:this.props.onClick},this.props.label)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],27:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"ObjectControl",mixins:[require("../../mixins/helper")],getInitialState:function getInitialState(){return{fieldTemplateIndex:0}},onSelect:function onSelect(index){this.setState({fieldTemplateIndex:index})},onAppend:function onAppend(){this.props.onAppend(this.state.fieldTemplateIndex)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;var fieldTemplates=config.fieldChildFieldTemplates(field);var typeChoices=null;if(fieldTemplates.length>0){typeChoices=config.createElement("field-template-choices",{field:field,fieldTemplateIndex:this.state.fieldTemplateIndex,onSelect:this.onSelect})}return R.div({className:cx(this.props.classes)},typeChoices," ",config.createElement("add-item",{onClick:this.onAppend}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],28:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"ObjectItemControl",mixins:[require("../../mixins/helper")],onRemove:function onRemove(){this.props.onRemove(this.props.itemKey)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return R.div({className:cx(this.props.classes)},config.createElement("remove-item",{field:field,onClick:this.onRemove}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],29:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"ObjectItemKey",mixins:[require("../../mixins/helper")],onChange:function onChange(event){this.props.onChange(event.target.value)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){return R.input({className:cx(this.props.classes),type:"text",value:this.props.displayKey,onChange:this.onChange})}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],30:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"ObjectItemValue",mixins:[require("../../mixins/helper")],onChangeField:function onChangeField(newValue,info){this.props.onChange(this.props.itemKey,newValue,info)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return R.div({className:cx(this.props.classes)},config.createFieldElement({field:field,onChange:this.onChangeField,plain:true}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],31:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"ObjectItem",mixins:[require("../../mixins/helper")],onChangeKey:function onChangeKey(newKey){this.props.onMove(this.props.itemKey,newKey)},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var config=this.props.config;var field=this.props.field;return R.div({className:cx(this.props.classes)},config.createElement("object-item-key",{field:field,onChange:this.onChangeKey,displayKey:this.props.displayKey,itemKey:this.props.itemKey}),config.createElement("object-item-value",{field:field,onChange:this.props.onChange,itemKey:this.props.itemKey}),config.createElement("object-item-control",{field:field,onRemove:this.props.onRemove,itemKey:this.props.itemKey}))}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],32:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"RemoveItem",mixins:[require("../../mixins/helper")],getDefaultProps:function getDefaultProps(){return{label:"[remove]"}},render:function render(){return this.renderWithConfig()},onMouseOverRemove:function onMouseOverRemove(){if(this.props.onMaybeRemove){this.props.onMaybeRemove(true)}},onMouseOutRemove:function onMouseOutRemove(){if(this.props.onMaybeRemove){this.props.onMaybeRemove(false)}},renderDefault:function renderDefault(){return R.span({className:cx(this.props.classes),onClick:this.props.onClick,onMouseOver:this.onMouseOverRemove,onMouseOut:this.onMouseOutRemove},this.props.label)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],33:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"Sample",mixins:[require("../../mixins/helper")],render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var choice=this.props.choice;return choice.sample?R.div({className:cx(this.props.className)},choice.sample):R.span(null)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],34:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var cx=React.addons.classSet;module.exports=React.createClass({displayName:"SelectValue",mixins:[require("../../mixins/helper")],onChange:function onChange(event){var choiceValue=event.target.value;var choiceType=choiceValue.substring(0,choiceValue.indexOf(":"));if(choiceType==="choice"){var choiceIndex=choiceValue.substring(choiceValue.indexOf(":")+1);choiceIndex=parseInt(choiceIndex);this.props.onChange(this.props.choices[choiceIndex].value)}},render:function render(){return this.renderWithConfig()},renderDefault:function renderDefault(){var choices=this.props.choices||[];var choicesOrLoading;if(choices.length===1&&choices[0].value==="///loading///"){choicesOrLoading=R.div({},"Loading choices...")}else{var value=this.props.field.value!==undefined?this.props.field.value:"";choices=choices.map(function(choice,i){return{choiceValue:"choice:"+i,value:choice.value,label:choice.label}});var valueChoice=_.find(choices,function(choice){return choice.value===value});if(valueChoice===undefined){var label=value;if(!_.isString(value)){label=JSON.stringify(value)}valueChoice={choiceValue:"value:",value:value,label:label};choices=[valueChoice].concat(choices)}choicesOrLoading=R.select({className:cx(this.props.classes),onChange:this.onChange,value:valueChoice.choiceValue,onFocus:this.onFocusAction,onBlur:this.onBlurAction},choices.map(function(choice,i){return R.option({key:i,value:choice.choiceValue},choice.label)}))}return choicesOrLoading}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../mixins/helper":39}],35:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var R=React.DOM;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var utils=require("./utils");module.exports={createElement_Fields:React.createFactory(require("./components/fields/fields")),createElement_String:React.createFactory(require("./components/fields/string")),createElement_SingleLineString:React.createFactory(require("./components/fields/single-line-string")),createElement_Select:React.createFactory(require("./components/fields/select")),createElement_Boolean:React.createFactory(require("./components/fields/boolean")),createElement_CheckboxBoolean:React.createFactory(require("./components/fields/checkbox-boolean")),createElement_PrettyText:React.createFactory(require("./components/fields/pretty-text")),createElement_Array:React.createFactory(require("./components/fields/array")),createElement_CheckboxArray:React.createFactory(require("./components/fields/checkbox-array")),createElement_Object:React.createFactory(require("./components/fields/object")),createElement_Json:React.createFactory(require("./components/fields/json")),createElement_UnknownField:React.createFactory(require("./components/fields/unknown")),createElement_Copy:React.createFactory(require("./components/fields/copy")),createElement_Field:React.createFactory(require("./components/helpers/field")),createElement_Label:React.createFactory(require("./components/helpers/label")),createElement_Help:React.createFactory(require("./components/helpers/help")),createElement_Choices:React.createFactory(require("./components/helpers/choices")),createElement_ArrayControl:React.createFactory(require("./components/helpers/array-control")),createElement_ArrayItemControl:React.createFactory(require("./components/helpers/array-item-control")),createElement_ArrayItemValue:React.createFactory(require("./components/helpers/array-item-value")),createElement_ArrayItem:React.createFactory(require("./components/helpers/array-item")),createElement_FieldTemplateChoices:React.createFactory(require("./components/helpers/field-template-choices")),createElement_AddItem:React.createFactory(require("./components/helpers/add-item")),createElement_RemoveItem:React.createFactory(require("./components/helpers/remove-item")),createElement_MoveItemForward:React.createFactory(require("./components/helpers/move-item-forward")),createElement_MoveItemBack:React.createFactory(require("./components/helpers/move-item-back")),createElement_ObjectControl:React.createFactory(require("./components/helpers/object-control")),createElement_ObjectItemControl:React.createFactory(require("./components/helpers/object-item-control")),createElement_ObjectItemValue:React.createFactory(require("./components/helpers/object-item-value")),createElement_ObjectItemKey:React.createFactory(require("./components/helpers/object-item-key")),createElement_ObjectItem:React.createFactory(require("./components/helpers/object-item")),createElement_SelectValue:React.createFactory(require("./components/helpers/select-value")),createElement_Sample:React.createFactory(require("./components/helpers/sample")),createDefaultValue_String:function createDefaultValue_String(){return""},createDefaultValue_Object:function createDefaultValue_Object(){return{}},createDefaultValue_Array:function createDefaultValue_Array(){return[]},createDefaultValue_Boolean:function createDefaultValue_Boolean(){return false},createDefaultValue_Fields:utils.delegateTo("createDefaultValue_Object"),createDefaultValue_SingleLineString:utils.delegateTo("createDefaultValue_String"),createDefaultValue_Select:utils.delegateTo("createDefaultValue_String"),createDefaultValue_Json:utils.delegateTo("createDefaultValue_Object"),createDefaultValue_CheckboxArray:utils.delegateTo("createDefaultValue_Array"),createDefaultValue_CheckboxBoolean:utils.delegateTo("createDefaultValue_Boolean"),coerceValue_String:function coerceValue_String(fieldTemplate,value){if(_.isString(value)){return value}if(_.isUndefined(value)||value===null){return""}return JSON.stringify(value)},coerceValue_Object:function coerceValue_Object(fieldTemplate,value){if(!_.isObject(value)){return{}}return value},coerceValue_Array:function coerceValue_Array(fieldTemplate,value){if(!_.isArray(value)){return[value]}return value},coerceValue_Boolean:function coerceValue_Boolean(fieldTemplate,value){return this.coerceValueToBoolean(value)},coerceValue_Fields:utils.delegateTo("coerceValue_Object"),coerceValue_SingleLineString:utils.delegateTo("coerceValue_String"),coerceValue_Select:utils.delegateTo("coerceValue_String"),coerceValue_Json:utils.delegateTo("coerceValue_Object"),coerceValue_CheckboxArray:utils.delegateTo("coerceValue_Array"),coerceValue_CheckboxBoolean:utils.delegateTo("coerceValue_Boolean"),createChildFields_Array:function createChildFields_Array(field){var config=this;return field.value.map(function(arrayItem,i){var childFieldTemplate=config.childFieldTemplateForValue(field,arrayItem);var childField=config.createChildField(field,{fieldTemplate:childFieldTemplate,key:i,fieldIndex:i,value:arrayItem});return childField})},createChildFields_Object:function createChildFields_Object(field){var config=this;return Object.keys(field.value).map(function(key,i){var childFieldTemplate=config.childFieldTemplateForValue(field,field.value[key]);
var childField=config.createChildField(field,{fieldTemplate:childFieldTemplate,key:key,fieldIndex:i,value:field.value[key]});return childField})},hasElementFactory:function hasElementFactory(name){var config=this;return config["createElement_"+name]?true:false},createElement:function createElement(name,props,children){var config=this;if(!props.config){props=_.extend({},props,{config:config})}name=config.elementName(name);if(config["createElement_"+name]){return config["createElement_"+name](props,children)}if(name!=="Unknown"){if(config.hasElementFactory("Unknown")){return config.createElement("Unknown",props,children)}}throw new Error("Factory not found for: "+name)},createFieldElement:function createFieldElement(props){var config=this;var name=config.fieldTypeName(props.field);if(config.hasElementFactory(name)){return config.createElement(name,props)}return config.createElement("UnknownField",props)},renderFormaticComponent:function renderFormaticComponent(component){var config=this;var props=component.props;var field=config.createRootField(props);return R.div({className:"formatic"},config.createFieldElement({field:field,onChange:component.onChange,onAction:component.onAction}))},renderComponent:function renderComponent(component){var config=this;var name=component.constructor.displayName;if(config["renderComponent_"+name]){return config["renderComponent_"+name](component)}return component.renderDefault()},renderFieldComponent:function renderFieldComponent(component){var config=this;return config.renderComponent(component)},elementName:function elementName(name){return utils.dashToPascal(name)},alias_Dict:"Object",alias_Bool:"Boolean",alias_PrettyTextarea:"PrettyText",alias_SingleLineString:function alias_SingleLineString(fieldTemplate){if(fieldTemplate.replaceChoices){return"PrettyText"}else if(fieldTemplate.choices){return"Select"}return"SingleLineString"},alias_String:function alias_String(fieldTemplate){var config=this;if(fieldTemplate.replaceChoices){return"PrettyText"}else if(fieldTemplate.choices){return"Select"}else if(config.fieldTemplateIsSingleLine(fieldTemplate)){return"SingleLineString"}return"String"},alias_Text:utils.delegateTo("alias_String"),alias_Unicode:utils.delegateTo("alias_SingleLineString"),alias_Str:utils.delegateTo("alias_SingleLineString"),alias_List:"Array",alias_CheckboxList:"CheckboxArray",alias_Fieldset:"Fields",alias_Checkbox:"CheckboxBoolean",inflateFieldValue:function inflateFieldValue(field){var config=this;if(config.fieldHasValueChildren(field)){var value=_.clone(field.value);var childFields=config.createChildFields(field);childFields.forEach(function(childField){if(config.isKey(childField.key)){value[childField.key]=config.inflateFieldValue(childField)}});return value}else{return field.value}},initRootField:function initRootField(){},initField:function initField(){},wrapFieldTemplates:function wrapFieldTemplates(fieldTemplates){return{type:"fields",plain:true,fields:fieldTemplates}},createRootField:function createRootField(props){var config=this;var fieldTemplate=props.fieldTemplate||props.fieldTemplates||props.field||props.fields;var value=props.value;if(!fieldTemplate){fieldTemplate=config.createFieldTemplateFromValue(value)}if(_.isArray(fieldTemplate)){fieldTemplate=config.wrapFieldTemplates(fieldTemplate)}var field=_.extend({},fieldTemplate,{rawFieldTemplate:fieldTemplate});if(config.hasValue(fieldTemplate,value)){field.value=config.coerceValue(fieldTemplate,value)}else{field.value=config.createDefaultValue(fieldTemplate)}config.initRootField(field,props);config.initField(field);if(value===null||config.isEmptyObject(value)||_.isUndefined(value)){field.value=config.inflateFieldValue(field)}return field},createRootValue:function createRootValue(props){var config=this;var field=config.createRootField(props);return config.inflateFieldValue(field)},createChildFields:function createChildFields(field){var config=this;var typeName=config.fieldTypeName(field);if(config["createChildFields_"+typeName]){return config["createChildFields_"+typeName](field)}return config.fieldChildFieldTemplates(field).map(function(childField,i){return config.createChildField(field,{fieldTemplate:childField,key:childField.key,fieldIndex:i,value:field.value[childField.key]})})},createChildField:function createChildField(parentField,options){var config=this;var childValue=options.value;var childField=_.extend({},options.fieldTemplate,{key:options.key,parent:parentField,fieldIndex:options.fieldIndex,rawFieldTemplate:options.fieldTemplate});if(config.hasValue(options.fieldTemplate,childValue)){childField.value=config.coerceValue(options.fieldTemplate,childValue)}else{childField.value=config.createDefaultValue(options.fieldTemplate)}config.initField(childField);return childField},createNewChildFieldValue:function createNewChildFieldValue(parentField,itemFieldIndex){var config=this;var childFieldTemplate=config.fieldItemFieldTemplates(parentField)[itemFieldIndex];var newValue=config.fieldTemplateValue(childFieldTemplate);var key="__unknown_key__";if(_.isArray(parentField.value)){key=parentField.value.length}var fieldIndex=0;if(_.isObject(parentField.value)){fieldIndex=Object.keys(parentField.value).length}var childField=config.createChildField(parentField,{fieldTemplate:childFieldTemplate,key:key,fieldIndex:fieldIndex,value:newValue});newValue=config.inflateFieldValue(childField);return newValue},createFieldTemplateFromValue:function createFieldTemplateFromValue(value){var config=this;var field={type:"json"};if(_.isString(value)){field={type:"string"}}else if(_.isNumber(value)){field={type:"number"}}else if(_.isBoolean(value)){field={type:"boolean"}}else if(_.isArray(value)){var arrayItemFields=value.map(function(childValue,i){var childField=config.createFieldTemplateFromValue(childValue);childField.key=i;return childField});field={type:"array",fields:arrayItemFields}}else if(_.isObject(value)){var objectItemFields=Object.keys(value).map(function(key){var childField=config.createFieldTemplateFromValue(value[key]);childField.key=key;childField.label=config.humanize(key);return childField});field={type:"object",fields:objectItemFields}}else if(_.isNull(value)){field={type:"json"}}return field},createDefaultValue:function createDefaultValue(fieldTemplate){var config=this;var defaultValue=config.fieldTemplateDefaultValue(fieldTemplate);if(!_.isUndefined(defaultValue)){return utils.deepCopy(defaultValue)}var typeName=config.fieldTypeName(fieldTemplate);if(config["createDefaultValue_"+typeName]){return config["createDefaultValue_"+typeName](fieldTemplate)}return""},hasValue:function hasValue(fieldTemplate,value){return value!==null&&!_.isUndefined(value)},coerceValue:function coerceValue(field,value){var config=this;var typeName=config.fieldTypeName(field);if(config["coerceValue_"+typeName]){return config["coerceValue_"+typeName](field,value)}return value},childFieldTemplateForValue:function childFieldTemplateForValue(field,childValue){var config=this;var fieldTemplate;var fieldTemplates=config.fieldItemFieldTemplates(field);fieldTemplate=_.find(fieldTemplates,function(itemFieldTemplate){return config.matchesFieldTemplateToValue(itemFieldTemplate,childValue)});if(fieldTemplate){return fieldTemplate}else{return config.createFieldTemplateFromValue(childValue)}},matchesFieldTemplateToValue:function matchesFieldTemplateToValue(fieldTemplate,value){var match=fieldTemplate.match;if(!match){return true}return _.every(_.keys(match),function(key){return _.isEqual(match[key],value[key])})},fieldTemplateTypeName:function fieldTemplateTypeName(fieldTemplate){var config=this;var typeName=utils.dashToPascal(fieldTemplate.type||"undefined");var alias=config["alias_"+typeName];if(alias){if(_.isFunction(alias)){return alias.call(config,fieldTemplate)}else{return alias}}if(fieldTemplate.list){typeName="Array"}return typeName},fieldTemplateDefaultValue:function fieldTemplateDefaultValue(fieldTemplate){return fieldTemplate["default"]},fieldTemplateValue:function fieldTemplateValue(fieldTemplate){var config=this;var defaultValue=config.fieldTemplateDefaultValue(fieldTemplate);var match=config.fieldTemplateMatch(fieldTemplate);var value;if(_.isUndefined(defaultValue)&&!_.isUndefined(match)){return utils.deepCopy(match)}else{return config.createDefaultValue(fieldTemplate)}return value},fieldTemplateMatch:function fieldTemplateMatch(fieldTemplate){return fieldTemplate.match},fieldTemplateIsSingleLine:function fieldTemplateIsSingleLine(fieldTemplate){return fieldTemplate.isSingleLine||fieldTemplate.is_single_line||fieldTemplate.type==="single-line-string"||fieldTemplate.type==="SingleLineString"},fieldValuePath:function fieldValuePath(field){var config=this;var parentPath=[];if(field.parent){parentPath=config.fieldValuePath(field.parent)}return parentPath.concat(field.key).filter(function(key){return!_.isUndefined(key)&&key!==""})},fieldWithValue:function fieldWithValue(field,value){return _.extend({},field,{value:value})},fieldTypeName:utils.delegateTo("fieldTemplateTypeName"),fieldChoices:function fieldChoices(field){var config=this;return config.normalizeChoices(field.choices)},fieldBooleanChoices:function fieldBooleanChoices(field){var config=this;var choices=config.fieldChoices(field);if(choices.length===0){return[{label:"Yes",value:true},{label:"No",value:false}]}return choices.map(function(choice){if(_.isBoolean(choice.value)){return choice}return _.extend({},choice,{value:config.coerceValueToBoolean(choice.value)})})},fieldReplaceChoices:function fieldReplaceChoices(field){var config=this;return config.normalizeChoices(field.replaceChoices)},fieldLabel:function fieldLabel(field){return field.label},fieldHelpText:function fieldHelpText(field){return field.help_text_html||field.help_text||field.helpText||field.helpTextHtml},fieldIsRequired:function fieldIsRequired(field){return field.required?true:false},fieldHasValueChildren:function fieldHasValueChildren(field){var config=this;var defaultValue=config.createDefaultValue(field);if(_.isObject(defaultValue)||_.isArray(defaultValue)){return true}return false},fieldChildFieldTemplates:function fieldChildFieldTemplates(field){return field.fields||[]},fieldItemFieldTemplates:function fieldItemFieldTemplates(field){if(!field.itemFields){return[{type:"text"}]}if(!_.isArray(field.itemFields)){return[field.itemFields]}return field.itemFields},fieldIsSingleLine:utils.delegateTo("fieldTemplateIsSingleLine"),fieldIsCollapsed:function fieldIsCollapsed(field){return field.collapsed?true:false},fieldIsCollapsible:function fieldIsCollapsible(field){return field.collapsible||!_.isUndefined(field.collapsed)},fieldRows:function fieldRows(field){return field.rows},fieldMatch:utils.delegateTo("fieldTemplateMatch"),humanize:function humanize(property){property=property.replace(/\{\{/g,"");property=property.replace(/\}\}/g,"");return property.replace(/_/g," ").replace(/(\w+)/g,function(match){return match.charAt(0).toUpperCase()+match.slice(1)})},normalizeChoices:function normalizeChoices(choices){var config=this;if(!choices){return[]}if(_.isString(choices)){choices=choices.split(",")}if(!_.isArray(choices)&&_.isObject(choices)){choices=Object.keys(choices).map(function(key){return{value:key,label:choices[key]}})}choices=choices.slice(0);choices=_.flatten(choices);choices.forEach(function(choice,i){if(_.isString(choice)){choices[i]={value:choice,label:config.humanize(choice)}}if(!choices[i].label){choices[i].label=config.humanize(choices[i].value)}});return choices},coerceValueToBoolean:function coerceValueToBoolean(value){if(!_.isString(value)){return value?true:false}value=value.toLowerCase();if(value===""||value==="no"||value==="off"||value==="false"){return false}return true},isKey:function isKey(key){return _.isNumber(key)&&key>=0||_.isString(key)&&key!==""},isEmptyObject:function isEmptyObject(obj){for(var key in obj){if(obj.hasOwnProperty(key)){return false}}return true}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./components/fields/array":2,"./components/fields/boolean":3,"./components/fields/checkbox-array":4,"./components/fields/checkbox-boolean":5,"./components/fields/copy":6,"./components/fields/fields":7,"./components/fields/json":8,"./components/fields/object":9,"./components/fields/pretty-text":10,"./components/fields/select":11,"./components/fields/single-line-string":12,"./components/fields/string":13,"./components/fields/unknown":14,"./components/helpers/add-item":15,"./components/helpers/array-control":16,"./components/helpers/array-item":19,"./components/helpers/array-item-control":17,"./components/helpers/array-item-value":18,"./components/helpers/choices":20,"./components/helpers/field":22,"./components/helpers/field-template-choices":21,"./components/helpers/help":23,"./components/helpers/label":24,"./components/helpers/move-item-back":25,"./components/helpers/move-item-forward":26,"./components/helpers/object-control":27,"./components/helpers/object-item":31,"./components/helpers/object-item-control":28,"./components/helpers/object-item-key":29,"./components/helpers/object-item-value":30,"./components/helpers/remove-item":32,"./components/helpers/sample":33,"./components/helpers/select-value":34,"./utils":47}],36:[function(require,module,exports){(function(global){"use strict";var React=typeof window!=="undefined"?window.React:typeof global!=="undefined"?global.React:null;var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var utils=require("./utils");var defaultConfig=require("./default-config");var FormaticControlledClass=React.createClass({displayName:"FormaticControlled",onChange:function onChange(newValue,info){if(!this.props.onChange){return}info=_.extend({},info);info.path=this.props.config.fieldValuePath(info.field);this.props.onChange(newValue,info)},onAction:function onAction(info){if(!this.props.onAction){return}info=_.extend({},info);info.path=this.props.config.fieldValuePath(info.field);this.props.onAction(info)},render:function render(){var config=this.props.config;return config.renderFormaticComponent(this)}});var FormaticControlled=React.createFactory(FormaticControlledClass);module.exports=React.createClass({statics:{createConfig:function createConfig(){var args=_.toArray(arguments);var config=_.extend({},defaultConfig);if(args.length===0){return config}var configs=[config].concat(args);return configs.reduce(function(prev,curr){if(_.isFunction(curr)){curr(prev);return prev}return _.extend(prev,curr)})},availableMixins:{clickOutside:require("./mixins/click-outside.js"),field:require("./mixins/field.js"),helper:require("./mixins/helper.js"),resize:require("./mixins/resize.js"),scroll:require("./mixins/scroll.js"),undoStack:require("./mixins/undo-stack.js")},plugins:{bootstrap:require("./plugins/bootstrap"),meta:require("./plugins/meta"),reference:require("./plugins/reference"),elementClasses:require("./plugins/element-classes")},utils:utils},displayName:"Formatic",getInitialState:function getInitialState(){return{isControlled:!_.isUndefined(this.props.value),value:_.isUndefined(this.props.value)?this.props.defaultValue:this.props.value}},componentWillReceiveProps:function componentWillReceiveProps(newProps){if(this.state.isControlled){if(!_.isUndefined(newProps.value)){this.setState({value:newProps.value})}}},onChange:function onChange(newValue,info){if(!this.state.isControlled){this.setState({value:newValue})}if(!this.props.onChange){return}this.props.onChange(newValue,info)},onAction:function onAction(info){if(this.props.onAction){this.props.onAction(info)}var action=utils.dashToPascal(info.action);if(this.props["on"+action]){this.props["on"+action](info)}},render:function render(){var config=this.props.config||defaultConfig;var value=this.state.value;if(this.state.isControlled){if(!this.props.onChange){console.log("You should supply an onChange handler if you supply a value.")}}var props={config:config,fieldTemplate:this.props.field,fieldTemplates:this.props.fields,value:value,onChange:this.onChange,onAction:this.onAction};_.each(this.props,function(propValue,key){if(!(key in props)){props[key]=propValue}});return FormaticControlled(props)}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./default-config":35,"./mixins/click-outside.js":37,"./mixins/field.js":38,"./mixins/helper.js":39,"./mixins/resize.js":40,"./mixins/scroll.js":41,"./mixins/undo-stack.js":42,"./plugins/bootstrap":43,"./plugins/element-classes":44,"./plugins/meta":45,"./plugins/reference":46,"./utils":47}],37:[function(require,module,exports){(function(global){"use strict";var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var hasAncestor=function(_hasAncestor){var _hasAncestorWrapper=function hasAncestor(_x,_x2){return _hasAncestor.apply(this,arguments)};_hasAncestorWrapper.toString=function(){return _hasAncestor.toString()};return _hasAncestorWrapper}(function(child,parent){if(child.parentNode===parent){return true}if(child.parentNode===null){return false}return hasAncestor(child.parentNode,parent)});module.exports={isNodeOutside:function isNodeOutside(nodeOut,nodeIn){if(nodeOut===nodeIn){return false}if(hasAncestor(nodeOut,nodeIn)){return false}return true},isNodeInside:function isNodeInside(nodeIn,nodeOut){return!this.isNodeOutside(nodeIn,nodeOut)},_onClickMousedown:function _onClickMousedown(){_.each(this.clickOutsideHandlers,function(funcs,ref){if(this.refs[ref]){this._mousedownRefs[ref]=true}}.bind(this))},_onClickMouseup:function _onClickMouseup(event){_.each(this.clickOutsideHandlers,function(funcs,ref){if(this.refs[ref]&&this._mousedownRefs[ref]){if(this.isNodeOutside(event.target,this.refs[ref].getDOMNode())){funcs.forEach(function(fn){fn.call(this,event)}.bind(this))}}this._mousedownRefs[ref]=false}.bind(this))},setOnClickOutside:function setOnClickOutside(ref,fn){if(!this.clickOutsideHandlers[ref]){this.clickOutsideHandlers[ref]=[]}this.clickOutsideHandlers[ref].push(fn)},componentDidMount:function componentDidMount(){this.clickOutsideHandlers={};this._didMouseDown=false;document.addEventListener("mousedown",this._onClickMousedown);document.addEventListener("mouseup",this._onClickMouseup);this._mousedownRefs={}},componentWillUnmount:function componentWillUnmount(){this.clickOutsideHandlers={};document.removeEventListener("mouseup",this._onClickMouseup);document.removeEventListener("mousedown",this._onClickMousedown)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],38:[function(require,module,exports){(function(global){"use strict";var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;module.exports={onChangeValue:function onChangeValue(value){this.props.onChange(value,{field:this.props.field})},onBubbleValue:function onBubbleValue(value,info){this.props.onChange(value,info)},onStartAction:function onStartAction(action,props){if(this.props.onAction){var info=_.extend({},props);info.action=action;info.field=this.props.field;this.props.onAction(info)}},onFocusAction:function onFocusAction(){this.onStartAction("focus")},onBlurAction:function onBlurAction(){this.onStartAction("blur")},onBubbleAction:function onBubbleAction(info){if(this.props.onAction){this.props.onAction(info)}},renderWithConfig:function renderWithConfig(){return this.props.config.renderFieldComponent(this)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],39:[function(require,module,exports){(function(global){"use strict";var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;module.exports={renderWithConfig:function renderWithConfig(){return this.props.config.renderComponent(this)},onStartAction:function onStartAction(action,props){if(this.props.onAction){var info=_.extend({},props);info.action=action;info.field=this.props.field;this.props.onAction(info)}},onBubbleAction:function onBubbleAction(info){if(this.props.onAction){this.props.onAction(info)}},onFocusAction:function onFocusAction(){this.onStartAction("focus")},onBlurAction:function onBlurAction(){this.onStartAction("blur")}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],40:[function(require,module,exports){"use strict";var id=0;var resizeIntervalElements={};var resizeIntervalElementsCount=0;var resizeIntervalTimer=null;var checkElements=function checkElements(){Object.keys(resizeIntervalElements).forEach(function(key){var element=resizeIntervalElements[key];if(element.clientWidth!==element.__prevClientWidth||element.clientHeight!==element.__prevClientHeight){element.__prevClientWidth=element.clientWidth;element.__prevClientHeight=element.clientHeight;var handlers=element.__resizeHandlers;handlers.forEach(function(handler){handler()})}},100)};var addResizeIntervalHandler=function addResizeIntervalHandler(element,fn){if(resizeIntervalTimer===null){resizeIntervalTimer=setInterval(checkElements,100)}if(!("__resizeId"in element)){id++;element.__prevClientWidth=element.clientWidth;element.__prevClientHeight=element.clientHeight;element.__resizeId=id;resizeIntervalElementsCount++;resizeIntervalElements[id]=element;element.__resizeHandlers=[]}element.__resizeHandlers.push(fn)};var removeResizeIntervalHandlers=function removeResizeIntervalHandlers(element){if(!("__resizeId"in element)){return}var resizeId=element.__resizeId;delete element.__resizeId;delete element.__resizeHandlers;delete resizeIntervalElements[resizeId];resizeIntervalElementsCount--;if(resizeIntervalElementsCount<1){clearInterval(resizeIntervalTimer);resizeIntervalTimer=null}};var onResize=function onResize(ref,fn){fn(ref)};module.exports={componentDidMount:function componentDidMount(){if(this.onResizeWindow){window.addEventListener("resize",this.onResizeWindow)}this.resizeElementRefs={}},componentWillUnmount:function componentWillUnmount(){if(this.onResizeWindow){window.removeEventListener("resize",this.onResizeWindow)}Object.keys(this.resizeElementRefs).forEach(function(ref){removeResizeIntervalHandlers(this.refs[ref].getDOMNode())}.bind(this))},setOnResize:function setOnResize(ref,fn){if(!this.resizeElementRefs[ref]){this.resizeElementRefs[ref]=true}addResizeIntervalHandler(this.refs[ref].getDOMNode(),onResize.bind(this,ref,fn))}}},{}],41:[function(require,module,exports){"use strict";module.exports=function(plugin){plugin.exports={componentDidMount:function componentDidMount(){if(this.onScrollWindow){window.addEventListener("scroll",this.onScrollWindow)}},componentWillUnmount:function componentWillUnmount(){if(this.onScrollWindow){window.removeEventListener("scroll",this.onScrollWindow)}}}}},{}],42:[function(require,module,exports){"use strict";module.exports={getInitialState:function getInitialState(){return{undo:[],redo:[]}},snapshot:function snapshot(){var undo=this.state.undo.concat(this.getStateSnapshot());if(typeof this.state.undoDepth==="number"){if(undo.length>this.state.undoDepth){undo.shift()}}this.setState({undo:undo,redo:[]})},hasUndo:function hasUndo(){return this.state.undo.length>0},hasRedo:function hasRedo(){return this.state.redo.length>0},redo:function redo(){this._undoImpl(true)},undo:function undo(){this._undoImpl()},_undoImpl:function _undoImpl(isRedo){var undo=this.state.undo.slice(0);var redo=this.state.redo.slice(0);var snapshot;if(isRedo){if(redo.length===0){return}snapshot=redo.pop();undo.push(this.getStateSnapshot())}else{if(undo.length===0){return}snapshot=undo.pop();redo.push(this.getStateSnapshot())}this.setStateSnapshot(snapshot);this.setState({undo:undo,redo:redo})}}},{}],43:[function(require,module,exports){(function(global){"use strict";var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var modifiers={Field:{classes:{"form-group":true}},Help:{classes:{"help-block":true}},Sample:{classes:{"help-block":true}},ArrayControl:{classes:{"form-inline":true}},ArrayItem:{classes:{well:true}},ObjectItem:{classes:{well:true}},FieldTemplateChoices:{classes:{"form-control":true}},AddItem:{classes:{"glyphicon glyphicon-plus":true},label:""},RemoveItem:{classes:{"glyphicon glyphicon-remove":true},label:""},MoveItemBack:{classes:{"glyphicon glyphicon-arrow-up":true},label:""},MoveItemForward:{classes:{"glyphicon glyphicon-arrow-down":true},label:""},ObjectItemKey:{classes:{"form-control":true}},SingleLineString:{classes:{"form-control":true}},String:{classes:{"form-control":true}},PrettyText:{classes:{"form-control":true}},Json:{classes:{"form-control":true}},SelectValue:{classes:{"form-control":true}}};module.exports=function(config){var defaultCreateElement=config.createElement;config.createElement=function(name,props,children){name=config.elementName(name);var modifier=modifiers[name];if(modifier){props=_.extend({},props);props.classes=_.extend({},props.classes,modifier.classes);if("label"in modifier){props.label=modifier.label}}return defaultCreateElement.call(this,name,props,children)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],44:[function(require,module,exports){(function(global){"use strict";var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;module.exports=function(config){var defaultCreateElement=config.createElement;var elementClasses={};config.addElementClass=function(name,className){name=config.elementName(name);if(!elementClasses[name]){elementClasses[name]={}}elementClasses[name][className]=true};config.createElement=function(name,props,children){name=config.elementName(name);if(elementClasses[name]){props=_.extend({},props,{classes:elementClasses[name]})}return defaultCreateElement.call(this,name,props,children)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],45:[function(require,module,exports){"use strict";module.exports=function(cfg){var initRootField=cfg.initRootField;cfg.initRootField=function(field,props){var config=this;field.meta=props.meta||{};initRootField.apply(config,arguments)};var initField=cfg.initField;cfg.initField=function(field){var config=this;if(field.parent&&field.parent.meta){field.meta=field.parent.meta}initField.apply(config,arguments)}}},{}],46:[function(require,module,exports){(function(global){"use strict";var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;module.exports=function(cfg){var initField=cfg.initField;cfg.findFieldTemplate=function(field,name){var config=this;if(field.templates[name]){return field.templates[name]}if(field.parent){return config.findFieldTemplate(field.parent,name)}return null};cfg.resolveFieldTemplate=function(field,fieldTemplate){var config=this;if(!fieldTemplate["extends"]){return fieldTemplate}var ext=fieldTemplate["extends"];if(!_.isArray(ext)){ext=[ext]}var bases=ext.map(function(base){var template=config.findFieldTemplate(field,base);if(!template){throw new Error("Template "+base+" not found.")}return template});var chain=[{}].concat(bases.reverse().concat([fieldTemplate]));fieldTemplate=_.extend.apply(_,chain);return fieldTemplate};cfg.initField=function(field){var config=this;var templates=field.templates={};var childFieldTemplates=config.fieldChildFieldTemplates(field);childFieldTemplates.forEach(function(fieldTemplate){if(_.isString(fieldTemplate)){return}var key=fieldTemplate.key;var id=fieldTemplate.id;if(fieldTemplate.template){fieldTemplate=_.extend({},fieldTemplate,{template:false})}if(!_.isUndefined(key)&&key!==""){templates[key]=fieldTemplate}if(!_.isUndefined(id)&&id!==""){templates[id]=fieldTemplate}});if(childFieldTemplates.length>0){field.fields=childFieldTemplates.map(function(fieldTemplate){if(_.isString(fieldTemplate)){fieldTemplate=config.findFieldTemplate(field,fieldTemplate)}return config.resolveFieldTemplate(field,fieldTemplate)});field.fields=field.fields.filter(function(fieldTemplate){return!fieldTemplate.template})}var itemFieldTemplates=config.fieldItemFieldTemplates(field);if(itemFieldTemplates.length>0){field.itemFields=itemFieldTemplates.map(function(itemFieldTemplate){if(_.isString(itemFieldTemplate)){itemFieldTemplate=config.findFieldTemplate(field,itemFieldTemplate)}return config.resolveFieldTemplate(field,itemFieldTemplate)})}initField.call(config,arguments)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],47:[function(require,module,exports){(function(global){"use strict";var _=typeof window!=="undefined"?window._:typeof global!=="undefined"?global._:null;var utils=exports;utils.deepCopy=function(obj){if(_.isArray(obj)){return obj.map(function(item){return utils.deepCopy(item)})}else if(_.isFunction(obj)){return obj}else if(_.isNull(obj)){return obj}else if(_.isObject(obj)){var copy={};_.each(obj,function(value,key){copy[key]=utils.deepCopy(value)});return copy}else{return obj}};var dashToPascalCache={};utils.dashToPascal=function(s){if(s===""){return""}if(!dashToPascalCache[s]){dashToPascalCache[s]=s.split("-").map(function(part){return part[0].toUpperCase()+part.substring(1)}).join("")}return dashToPascalCache[s]};utils.copyElementStyle=function(fromElement,toElement){var fromStyle=window.getComputedStyle(fromElement,"");if(fromStyle.cssText!==""){toElement.style.cssText=fromStyle.cssText;return}var cssRules=[];for(var i=0;i<fromStyle.length;i++){cssRules.push(fromStyle[i]+":"+fromStyle.getPropertyValue(fromStyle[i])+";")}var cssText=cssRules.join("");toElement.style.cssText=cssText};var browser={isChrome:false,isMozilla:false,isOpera:false,isIe:false,isSafari:false,isUnknown:false};var ua="";if(typeof navigator!=="undefined"){ua=navigator.userAgent}if(ua.indexOf("Chrome")>-1){browser.isChrome=true}else if(ua.indexOf("Safari")>-1){browser.isSafari=true}else if(ua.indexOf("Opera")>-1){browser.isOpera=true}else if(ua.indexOf("Firefox")>-1){browser.isMozilla=true}else if(ua.indexOf("MSIE")>-1){browser.isIe=true}else{browser.isUnknown=true}utils.browser=browser;utils.delegateTo=function(name){return function(){return this[name].apply(this,arguments)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[1])(1)});