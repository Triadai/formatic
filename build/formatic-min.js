!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Formatic=e()}}(function(){return function e(t,n,i){function o(r,a){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var f=new Error("Cannot find module '"+r+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){var n=t[r][1][e];return o(n?n:e)},c,c.exports,e,t,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t=e.require("util"),i=function(e){return n.isString(e)&&(e=e.split(",")),!n.isArray(e)&&n.isObject(e)&&(e=Object.keys(e).map(function(t){return{value:t,label:e[t]}})),e=e.slice(0),e=n.flatten(e),e.forEach(function(i,o){n.isString(i)&&(e[o]={value:i,label:t.humanize(i)}),e[o].label||(e[o].label=t.humanize(e[o].value))}),e};e.exports.compile=function(e){""===e.choices?e.choices=[]:e.choices&&(e.choices=i(e.choices)),""===e.replaceChoices?e.replaceChoices=[]:e.replaceChoices&&(e.replaceChoices=i(e.replaceChoices),e.replaceChoicesLabels={},e.replaceChoices.forEach(function(t){e.replaceChoicesLabels[t.value]=t.label}))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t){"use strict";t.exports=function(e){var t=function(e,t,n){var i=e[t];if(i){e[n]||(e[n]=[]),e.eval||(e.eval={}),e.eval.needsMeta||(e.eval.needsMeta=[]);var o,s,r,a=i.keys||[],l={};if(i.group){a.forEach(function(e){l[e]=["@get","item",e]}),o=[i.source].concat(l),s=["@getMeta"].concat(o);var f=["@forEach","item",["@getGroupValues",i.group]];e.eval.needsMeta.push(f.concat([o,["@not",s]])),r=["@and"].concat(a.map(function(e){return["@get","item",e]})),e.eval[n]=f.concat([["@or",s,["@if",r,["///loading///"],[]]],["@or",r,s]])}else{a.forEach(function(e){l[e]=["@get",e]}),o=[i.source].concat(l),s=["@getMeta"].concat(o);var c=["@or",s,["///loading///"]];e.eval.needsMeta.push(["@if",s,null,o]),e.eval[n]=c,a.length>0&&(r=["@and"].concat(a.map(function(e){return["@get",e]})),r=["@not",r],e.eval.hidden||(e.eval.hidden=r))}delete e[t]}};e.exports.compile=function(e){t(e,"lookup","choices"),t(e,"lookupReplacements","replaceChoices")}}},{}],3:[function(e,t){"use strict";t.exports=function(e){var t={help_text:"helpText"};e.exports.compile=function(e){Object.keys(t).forEach(function(n){var i=t[n];"undefined"==typeof e[i]&&"undefined"!=typeof e[n]&&(e[i]=e[n])})}}},{}],4:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t={unicode:function(e){e.type="string",e.maxRows=1},text:"string",select:function(e){e.choices=e.choices||[]},bool:"boolean",dict:"object",decimal:"number","int":"number"};t.str=t.unicode,e.exports.compile=function(e){var i=t[e.type];i&&(n.isString(i)?e.type=i:n.isFunction(i)&&(e=i(e)))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className,label:e.configValue("label","[add]")}},render:function(){return i.span({className:this.props.className,onClick:this.props.onClick},this.props.label)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM,o="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){e.exports=n.createClass({displayName:e.name,mixins:[e.require("mixin.field")],getDefaultProps:function(){return{className:e.config.className}},onChange:function(){var e=this.refs.choices.getDOMNode().getElementsByTagName("input");e=Array.prototype.slice.call(e,0);var t=e.map(function(e){return e.checked?e.value:null}).filter(function(e){return e});this.props.field.val(t)},render:function(){var t=this.props.field,n=t.def.choices||[],s=!o.find(n,function(e){return e.sample}),r=t.value||[];return e.component("field")({field:t},i.div({className:this.props.className,ref:"choices"},n.map(function(n,o){var a=i.span({style:{whiteSpace:"nowrap"}},i.input({name:t.def.key,type:"checkbox",value:n.value,checked:r.indexOf(n.value)>=0?!0:!1,onChange:this.onChange})," ",i.span({className:"field-choice-label"},n.label));return s?i.span({key:o,className:"field-choice"},a," "):i.div({key:o,className:"field-choice"},a," ",e.component("sample")({field:t,choice:n}))}.bind(this))))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM,o="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,s=n.createFactory(n.addons.CSSTransitionGroup);t.exports=function(e){e.exports=n.createClass({mixins:[e.require("mixin.click-outside")],getInitialState:function(){return{maxHeight:null,open:this.props.open}},getIgnoreCloseNodes:function(){if(!this.props.ignoreCloseNodes)return[];var e=this.props.ignoreCloseNodes();return o.isArray(e)||(e=[e]),e},componentDidMount:function(){this.setOnClickOutside("choices",function(e){o.find(this.getIgnoreCloseNodes(),function(t){return this.isNodeInside(e.target,t)}.bind(this))||this.props.onClose()}.bind(this)),this.adjustSize()},onSelect:function(e){this.props.onSelect(e.value)},onResizeWindow:function(){this.adjustSize()},onScrollWindow:function(){this.adjustSize()},adjustSize:function(){if(this.refs.choices){var e=this.refs.choices.getDOMNode(),t=e.getBoundingClientRect(),n=t.top,i=window.innerHeight,o=i-n;this.setState({maxHeight:o})}},componentWillReceiveProps:function(e){this.setState({open:e.open},function(){this.adjustSize()}.bind(this))},onScroll:function(){},onWheel:function(){},render:function(){var e=this.props.choices;return e&&0===e.length&&(e=[{value:"///empty///"}]),i.div({ref:"container",onWheel:this.onWheel,onScroll:this.onScroll,className:"choices-container",style:{userSelect:"none",WebkitUserSelect:"none",position:"absolute",maxHeight:this.state.maxHeight?this.state.maxHeight:null}},s({transitionName:"reveal"},this.props.open?i.ul({ref:"choices",className:"choices"},e.map(function(e,t){var n=null;return n="///loading///"===e.value?i.a({href:"JavaScript:",onClick:this.props.onClose},i.span({className:"choice-label"},"Loading...")):"///empty///"===e.value?i.a({href:"JavaScript:",onClick:this.props.onClose},i.span({className:"choice-label"},"No choices available.")):i.a({href:"JavaScript:",onClick:this.onSelect.bind(this,e)},i.span({className:"choice-label"},e.label),i.span({className:"choice-sample"},e.sample)),i.li({key:t,className:"choice"},n)}.bind(this))):null))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM,o="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,s=n.createFactory(n.addons.CSSTransitionGroup);t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},getInitialState:function(){return{collapsed:this.props.field.def.collapsed?!0:!1}},isCollapsible:function(){var e=this.props.field;return!o.isUndefined(e.def.collapsed)||!o.isUndefined(e.def.collapsible)},onClickLabel:function(){this.setState({collapsed:!this.state.collapsed})},render:function(){var t=this.props.field,n=this.props.index;return o.isNumber(n)||(n=o.isNumber(t.def.key)?t.def.key:void 0),i.div({className:this.props.className,style:{display:t.hidden()?"none":""}},e.component("label")({field:t,index:n,onClick:this.isCollapsible()?this.onClickLabel:null}),s({transitionName:"reveal"},this.state.collapsed?[]:[e.component("help")({key:"help",field:t}),this.props.children]))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,mixins:[e.require("mixin.field")],getDefaultProps:function(){return{className:e.config.className}},render:function(){var t=this.props.field;return e.component("field")({field:t},i.fieldset({className:this.props.className},t.fields().map(function(e,t){return e.component({key:e.def.key||t})}.bind(this))))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getInitialState:function(){return{field:this.props.form.field()}},componentDidMount:function(){var e=this.props.form;e.on("change",this.onFormChanged)},componentWillUnmount:function(){var e=this.props.form;e.off("change",this.onFormChanged)},onFormChanged:function(e){this.props.onChange&&this.props.onChange(this.props.form.val(),e.changing),this.setState({field:this.props.form.field()})},render:function(){return i.div({className:"formatic"},this.state.field.component())}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},render:function(){var e=this.props.field;return e.def.helpText?i.div({className:this.props.className},e.def.helpText):i.span(null)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],12:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},onChange:function(e){this.props.onSelect(parseInt(e.target.value))},render:function(){var e=this.props.field,t=null;return e.items().length>0&&(t=i.select({className:this.props.className,value:this.value,onChange:this.onChange},e.items().map(function(e,t){return i.option({key:t,value:t},e.label||t)}))),t?t:i.span(null)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,mixins:[e.require("mixin.field")],getDefaultProps:function(){return{className:e.config.className,rows:e.config.rows||5}},isValidValue:function(e){try{return JSON.parse(e),!0}catch(t){return!1}},getInitialState:function(){return{isValid:!0,value:JSON.stringify(this.props.field.value,null,2)}},onChange:function(e){var t=this.isValidValue(e.target.value);t&&(this._isChanging=!0,this.props.field.val(JSON.parse(e.target.value))),this.setState({isValid:t,value:e.target.value})},componentWillReceiveProps:function(e){this._isChanging||this.setState({isValid:!0,value:JSON.stringify(e.field.value,null,2)}),this._isChanging=!1},render:function(){var t=this.props.field;return e.component("field")({field:t},i.textarea({className:this.props.className,value:this.state.value,onChange:this.onChange,style:{backgroundColor:this.state.isValid?"":"rgb(255,200,200)"},rows:t.def.rows||this.props.rows}))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},render:function(){var e=this.props.field,t=null;if("number"==typeof this.props.index&&(t=""+(this.props.index+1)+".",e.def.label&&(t=t+" "+e.def.label)),e.def.label||t){var n=t||e.def.label;this.props.onClick&&(n=i.a({href:"JavaScript:",onClick:this.props.onClick},n)),t=i.label({},n)}var o=i.span({className:"required-text"});return i.div({className:this.props.className},t," ",o)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},getInitialState:function(){return{itemIndex:0}},onSelect:function(e){this.setState({itemIndex:e})},onAppend:function(){this.props.onAppend(this.state.itemIndex)},render:function(){var t=this.props.field,n=null;return t.items().length>0&&(n=e.component("item-choices")({field:t,value:this.state.itemIndex,onSelect:this.onSelect})),i.div({className:this.props.className},n," ",e.component("add-item")({onClick:this.onAppend}))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},onMoveBack:function(){this.props.onMove(this.props.index,this.props.index-1)},onMoveForward:function(){this.props.onMove(this.props.index,this.props.index+1)},onRemove:function(){this.props.onRemove(this.props.index)},render:function(){var t=this.props.field;return i.div({className:this.props.className},e.component("remove-item")({field:t,onClick:this.onRemove}),this.props.index>0?e.component("move-item-back")({onClick:this.onMoveBack}):null,this.props.index<this.props.numItems-1?e.component("move-item-forward")({onClick:this.onMoveForward}):null)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},render:function(){var e=this.props.field;return i.div({className:this.props.className},e.component())}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},render:function(){var t=this.props.field;return i.div({className:this.props.className},e.component("list-item-value")({form:this.props.form,field:t,index:this.props.index}),e.component("list-item-control")({field:t,index:this.props.index,numItems:this.props.numItems,onMove:this.props.onMove,onRemove:this.props.onRemove}))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM,o=n.createFactory(n.addons.CSSTransitionGroup);t.exports=function(e){e.exports=n.createClass({displayName:e.name,mixins:[e.require("mixin.field")],getDefaultProps:function(){return{className:e.config.className}},nextLookupId:0,getInitialState:function(){var e=[];return this.props.field.fields().forEach(function(t,n){e[n]="_"+this.nextLookupId,this.nextLookupId++}.bind(this)),{lookups:e}},componentWillReceiveProps:function(e){var t=this.state.lookups,n=e.field.fields();if(n.length>t.length)for(var i=t.length;i<n.length;i++)t[i]="_"+this.nextLookupId,this.nextLookupId++;this.setState({lookups:t})},onAppend:function(e){this.props.field.append(e)},onRemove:function(e){var t=this.state.lookups;t.splice(e,1),this.setState({lookups:t}),this.props.field.remove(e)},onMove:function(e,t){var n=this.state.lookups,i=n[e],o=n[t];n[e]=o,n[t]=i,this.setState({lookups:n}),this.props.field.move(e,t)},render:function(){var t=this.props.field,n=t.fields(),s=n.length;return e.component("field")({field:t},i.div({className:this.props.className},o({transitionName:"reveal"},n.map(function(n,i){return e.component("list-item")({key:this.state.lookups[i],form:this.props.form,field:n,parent:t,index:i,numItems:s,onMove:this.onMove,onRemove:this.onRemove})}.bind(this))),e.component("list-control")({field:t,onAppend:this.onAppend})))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className,label:e.configValue("label","[up]")}},render:function(){return i.span({className:this.props.className,onClick:this.props.onClick},this.props.label)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className,label:e.configValue("label","[down]")}},render:function(){return i.span({className:this.props.className,onClick:this.props.onClick},this.props.label)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM,o="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,s=function(e){return e.replace(/ /g," ")},r="  ",a="  ",l=/^[0-9]+__/,f=function(e){return l.test(e)?e.replace(l,""):e},c=function(e,t){var n=t.getBoundingClientRect();return e.x>=n.left&&e.x<=n.right&&e.y>=n.top&&e.y<=n.bottom?!0:void 0};t.exports=function(e){var t=e.require("util");e.exports=n.createClass({displayName:e.name,mixins:[e.require("mixin.field"),e.require("mixin.undo-stack"),e.require("mixin.resize")],getDefaultProps:function(){return{className:e.config.className}},getInitialState:function(){return{undoDepth:100,isChoicesOpen:!1,hoverPillRef:null}},componentWillMount:function(){this.tracking={};var e=t.parseTextWithTags(this.props.field.value),n=this.tokens(e),i=this.indexMap(n);this.tracking.pos=i.length,this.tracking.range=0,this.tracking.tokens=n,this.tracking.indexMap=i},getStateSnapshot:function(){return{value:this.props.field.value,pos:this.tracking.pos,range:this.tracking.range}},setStateSnapshot:function(e){this.tracking.pos=e.pos,this.tracking.range=e.range,this.props.field.val(e.value)},tokens:function(e){return[].concat.apply([],e.map(function(e){return"tag"===e.type?e:e.value.split("")}))},indexMap:function(e){var t=[];return o.each(e,function(e,n){if("tag"===e.type){var i=r+s(this.prettyLabel(e.value))+a,l=i.split("");o.each(l,function(){t.push(n)})}else t.push(n)}.bind(this)),t},onScroll:function(){this.refs.highlight.getDOMNode().scrollTop=this.refs.content.getDOMNode().scrollTop,this.refs.highlight.getDOMNode().scrollLeft=this.refs.content.getDOMNode().scrollLeft},tokenIndex:function(e,t,n){if(0>e)e=0;else if(e>=n.length)return t.length;return n[e]},onChange:function(e){var t=e.target,n=this.tracking.pos,i=this.tracking.range,o=t.selectionStart,s=this.tracking.tokens,r=this.tokenIndex(n,s,this.tracking.indexMap),a=this.tokenIndex(n+i,s,this.tracking.indexMap),l=a-r;if(l>0&&(s.splice(r,l),this.tracking.indexMap=this.indexMap(s)),o>n){var f=t.value.substring(n,o);s.splice(r,0,f)}if(n>o){var c=this.tokenAt(o),u=this.tokenBefore(o);c===u&&(o=this.moveOffTag(o,s,this.indexMap(s),-1));var d=this.tokenIndex(o,s,this.tracking.indexMap);s.splice(d,r-d)}var p=this.rawValue(s);this.tracking.pos=o,this.tracking.range=0,this.props.field.val(p),this.snapshot()},componentDidUpdate:function(){var e=this.props.field.value||"",n=t.parseTextWithTags(e);this.tracking.tokens=this.tokens(n),this.tracking.indexMap=this.indexMap(this.tracking.tokens);var i=this.normalizePosition(this.tracking.pos),o=this.tracking.range,s=this.normalizePosition(i+o);o=s-i,this.tracking.pos=i,this.tracking.range=o,document.activeElement===this.refs.content.getDOMNode()&&this.refs.content.getDOMNode().setSelectionRange(i,i+o)},prettyLabel:function(e){if(this.props.field.def.replaceChoicesLabels[e])return this.props.field.def.replaceChoicesLabels[e];var n=f(e);return t.humanize(n)},plainValue:function(e){var n=t.parseTextWithTags(e);return n.map(function(e){return"text"===e.type?e.value:r+s(this.prettyLabel(e.value))+a}.bind(this)).join("")},prettyValue:function(e){var n=t.parseTextWithTags(e);return n.map(function(e,t){if("text"===e.type)return t===n.length-1&&"\n"===e.value[e.value.length-1]?e.value+" ":e.value;var o="prettyPart"+t,l="pretty-part";return this.state.hoverPillRef&&o===this.state.hoverPillRef&&(l+=" pretty-part-hover"),i.span({key:t,className:l,ref:o,"data-pretty":!0,"data-ref":o},i.span({className:"pretty-part-left"},r),i.span({className:"pretty-part-text"},s(this.prettyLabel(e.value))),i.span({className:"pretty-part-right"},a))}.bind(this))},rawValue:function(e){return e.map(function(e){return"tag"===e.type?"{{"+e.value+"}}":e}).join("")},moveOffTag:function(e,t,n,i){i="undefined"==typeof i||i>0?1:-1;var o;if(i>0)for(o=t[n[e]];e<n.length&&"tag"===t[n[e]].type&&t[n[e]]===o;)e++;else for(o=t[n[e-1]];e>0&&"tag"===t[n[e-1]].type&&t[n[e-1]]===o;)e--;return e},tokenAt:function(e){return e>=this.tracking.indexMap.length?null:(0>e&&(e=0),this.tracking.tokens[this.tracking.indexMap[e]])},tokenBefore:function(e){return e>=this.tracking.indexMap.length&&(e=this.tracking.indexMap.length),0>=e?null:this.tracking.tokens[this.tracking.indexMap[e-1]]},normalizePosition:function(e,t){if(o.isUndefined(t)&&(t=e),0>=e||e>=this.tracking.indexMap.length)return 0>e&&(e=0),e>this.tracking.indexMap.length&&(e=this.tracking.indexMap.length),e;var n=this.tokenAt(e),i=this.tokenBefore(e);if(n!==i)return e;var s=this.tokenAt(t),r=this.tokenBefore(t),a=this.moveOffTag(e,this.tracking.tokens,this.tracking.indexMap),l=this.moveOffTag(e,this.tracking.tokens,this.tracking.indexMap,-1);if(s!==r){if(s===n)return a;if(r===n)return l}var f=a;return(e===t||t>e)&&a-e>e-l&&(f=l),f},onSelect:function(e){var t=e.target,n=t.selectionStart,i=t.selectionEnd;if(n===i&&!this.leftArrowDown&&!this.rightArrowDown){var o=this.tokenAt(n),s=this.tokenBefore(n);if(o&&o===s&&o.type&&"tag"===o.type){var r=this.moveOffTag(n,this.tracking.tokens,this.tracking.indexMap),a=this.moveOffTag(n,this.tracking.tokens,this.tracking.indexMap,-1);return this.tracking.pos=a,this.tracking.range=r-a,t.selectionStart=a,t.selectionEnd=r,void this.setState({isChoicesOpen:!0})}}n=this.normalizePosition(n,this.tracking.pos),i=this.normalizePosition(i,this.tracking.pos+this.tracking.range),this.tracking.pos=n,this.tracking.range=i-n,t.selectionStart=n,t.selectionEnd=i},onCopy:function(){var e=this.refs.content.getDOMNode(),t=e.selectionStart,n=e.selectionEnd,i=e.value.substring(t,n),o=this.tokenIndex(t,this.tracking.tokens,this.tracking.indexMap),s=this.tokenIndex(n,this.tracking.tokens,this.tracking.indexMap),r=this.tracking.tokens.slice(o,s);i=this.rawValue(r);var a=e.value;e.value=e.value+i,e.setSelectionRange(a.length,a.length+i.length),window.setTimeout(function(){e.value=a,e.setSelectionRange(t,n)},0)},onCut:function(){var e=this.refs.content.getDOMNode(),t=e.selectionStart,n=e.selectionEnd,i=e.value.substring(t,n),o=this.tokenIndex(t,this.tracking.tokens,this.tracking.indexMap),s=this.tokenIndex(n,this.tracking.tokens,this.tracking.indexMap),r=this.tracking.tokens.slice(o,s);i=this.rawValue(r);var a=e.value,l=e.value.substring(0,t)+e.value.substring(n);e.value=e.value+i,e.setSelectionRange(a.length,a.length+i.length);var f=this.tracking.tokens.slice(0,o).concat(this.tracking.tokens.slice(s));window.setTimeout(function(){e.value=l,e.setSelectionRange(t,t),this.tracking.pos=t,this.tracking.range=0,this.tracking.tokens=f,this.tracking.indexMap=this.indexMap(this.tracking.tokens);var n=this.rawValue(this.tracking.tokens);this.props.field.val(n),this.snapshot()}.bind(this),0)},onKeyDown:function(e){37===e.keyCode?this.leftArrowDown=!0:39===e.keyCode&&(this.rightArrowDown=!0),90!==e.keyCode||!e.metaKey&&!e.ctrlKey||e.shiftKey?(89===e.keyCode&&e.ctrlKey&&!e.shiftKey||90===e.keyCode&&e.metaKey&&e.shiftKey)&&this.redo():(e.preventDefault(),this.undo())},onKeyUp:function(e){37===e.keyCode?this.leftArrowDown=!1:39===e.keyCode&&(this.rightArrowDown=!1)},adjustStyles:function(e){var n=this.refs.highlight.getDOMNode(),i=this.refs.content.getDOMNode(),o=window.getComputedStyle(i),s=o.backgroundColor;if(t.copyElementStyle(i,n),n.style.position="absolute",n.style.whiteSpace="pre-wrap",n.style.color="rgba(0,0,0,0)",n.style.webkitTextFillColor="rgba(0,0,0,0)",n.style.resize="none",n.style.borderColor="rgba(0,0,0,0)",t.browser.isMozilla){var r=parseFloat(o.paddingTop),a=parseFloat(o.paddingBottom),l=parseFloat(o.borderTopWidth),f=parseFloat(o.borderBottomWidth);n.style.paddingTop="0px",n.style.paddingBottom="0px",n.style.height=i.clientHeight-r-a+l+f+"px",n.style.top=o.paddingTop,n.style.boxShadow="none"}e&&(this.backgroundColor=s),n.style.backgroundColor=this.backgroundColor,i.style.backgroundColor="rgba(0,0,0,0)"},onResize:function(){this.adjustStyles()},onResizeWindow:function(){this.adjustStyles()},componentDidMount:function(){this.adjustStyles(!0),this.setOnResize("content",this.onResize)},onInsertFromSelect:function(e){if(e.target.selectedIndex>0){var t=e.target.value;e.target.selectedIndex=0;var n=this.tracking.pos,i=this.normalizePosition(n),o=this.tracking.tokens,s=this.tokenIndex(i,o,this.tracking.indexMap);o.splice(s,0,{type:"tag",value:t}),this.tracking.indexMap=this.indexMap(o);var r=this.rawValue(o);this.tracking.pos+=this.prettyLabel(t).length,this.props.field.val(r)}},onInsert:function(e){var t=e,n=this.tracking.pos,i=this.tracking.pos+this.tracking.range,o=this.normalizePosition(n),s=this.normalizePosition(i),r=this.tracking.tokens,a=this.tokenIndex(o,r,this.tracking.indexMap),l=this.tokenIndex(s,r,this.tracking.indexMap);r.splice(a,l-a,{type:"tag",value:t}),this.tracking.indexMap=this.indexMap(r);var f=this.rawValue(r);this.tracking.pos+=this.prettyLabel(t).length,this.props.field.val(f),this.setState({isChoicesOpen:!1})},onToggleChoices:function(){this.setState({isChoicesOpen:!this.state.isChoicesOpen})},onCloseChoices:function(){this.setState({isChoicesOpen:!1})},getCloseIgnoreNodes:function(){return this.refs.toggle.getDOMNode()},onClickOutsideChoices:function(){},onMouseMove:function(e){for(var t={x:e.clientX,y:e.clientY},n=this.refs.highlight.getDOMNode().childNodes,i=null,o=0;o<n.length;o++){var s=n[o];if(n[o].getAttribute("data-pretty")&&c(t,s)){i=s;break}}i?this.state.hoverPillRef!==i.getAttribute("data-ref")&&this.setState({hoverPillRef:i.getAttribute("data-ref")}):this.state.hoverPillRef&&this.setState({hoverPillRef:null})},render:function(){var n=this.props.field,s=n.def.replaceChoices;return e.component("field")({field:n},i.div({style:{position:"relative"}},i.pre({className:"pretty-highlight",ref:"highlight"},this.prettyValue(n.value)),i.textarea(o.extend({className:t.className(this.props.className,"pretty-content"),ref:"content",rows:n.def.rows||this.props.rows,name:n.key,value:this.plainValue(n.value),onChange:this.onChange,onScroll:this.onScroll,style:{position:"relative",top:0,left:0,cursor:this.state.hoverPillRef?"pointer":null},onKeyPress:this.onKeyPress,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onSelect:this.onSelect,onCopy:this.onCopy,onCut:this.onCut,onMouseMove:this.onMouseMove},e.config.attributes)),i.a({ref:"toggle",href:"JavaScript:",onClick:this.onToggleChoices},"Insert..."),e.component("choices")({ref:"choices",choices:s,open:this.state.isChoicesOpen,onSelect:this.onInsert,onClose:this.onCloseChoices,ignoreCloseNodes:this.getCloseIgnoreNodes})))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],23:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className,label:e.configValue("label","[remove]")}},render:function(){return i.span({className:this.props.className,onClick:this.props.onClick},this.props.label)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],24:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){var t=e.require("util");e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:t.className("root",e.config.className)}},render:function(){var e=this.props.field;return i.div({className:this.props.className},e.fields().map(function(e,t){return e.component({key:e.def.key||t})}))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,getDefaultProps:function(){return{className:e.config.className}},render:function(){var e=this.props.choice;return e.sample?i.div({className:this.props.className},e.sample):i.span(null)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM,o="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){e.exports=n.createClass({displayName:e.name,mixins:[e.require("mixin.field")],getDefaultProps:function(){return{className:e.config.className}},onChange:function(e){var t=e.target.value,n=t.substring(0,t.indexOf(":"));if("choice"===n){var i=t.substring(t.indexOf(":")+1);i=parseInt(i),this.props.field.val(this.props.field.def.choices[i].value)}},render:function(){var t,n=this.props.field,s=n.def.choices||[];if(1===s.length&&"///loading///"===s[0].value)t=i.div({},"Loading choices...");else{var r=void 0!==n.value?n.value:"";s=s.map(function(e,t){return{choiceValue:"choice:"+t,value:e.value,label:e.label}
});var a=o.find(s,function(e){return e.value===r});if(void 0===a){var l=r;o.isString(r)||(l=JSON.stringify(r)),a={choiceValue:"value:",value:r,label:l},s=[a].concat(s)}t=i.select({className:this.props.className,onChange:this.onChange,value:a.choiceValue},s.map(function(e,t){return i.option({key:t,value:e.choiceValue},e.label)}.bind(this)))}return e.component("field")({field:n},t)}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,mixins:[e.require("mixin.field")],getDefaultProps:function(){return{className:e.config.className}},onChange:function(e){var t=e.target.value;this.props.field.val(t)},render:function(){var t=this.props.field;return e.component("field")({field:t},i.input({className:this.props.className,type:"text",value:t.value,rows:t.def.rows,onChange:this.onChange}))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i=n.DOM;t.exports=function(e){e.exports=n.createClass({displayName:e.name,mixins:[e.require("mixin.field")],getDefaultProps:function(){return{className:e.config.className,rows:e.config.rows||5}},onChange:function(e){var t=e.target.value;this.props.field.val(t)},render:function(){var t=this.props.field;return e.component("field")({field:t},i.textarea({className:this.props.className,value:t.value,rows:t.def.rows||this.props.rows,onChange:this.onChange}))}})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],29:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t=e.require("field-router"),i=e.require("util"),o=e.require("eval"),s=e.require("compiler"),r=function(e,t,n,i){var o=this;o.form=e,o.def=t,o.value=n,o.parent=i,o.groups={},o.tempChildren=[]};e.exports.field=function(){var e=this;return new r(e,{type:"root"},e.store.value)};var a=r.prototype;a.typePlugin=function(){var t=this;return t._typePlugin||(t._typePlugin=e.require("type."+t.def.type)),t._typePlugin},a.component=function(e){var i=this;e=n.extend({},e,{field:i});var o=t.componentForField(i);return o(e)},a.fields=function(){var e=this;if(!e._fields){var t;t=e.typePlugin().fields?e.typePlugin().fields(e):e.def.fields?e.def.fields.map(function(t){return e.createChild(t)}):[],e._fields=t}return e._fields},a.items=function(){var e=this;return e._items||(e._items=n.isArray(e.def.items)?e.def.items.map(function(t){return e.resolve(t)}):[]),e._items},a.resolve=function(e){var t=this;if(n.isString(e)&&(e=t.form.findDef(e),!e))throw new Error("Could not find field: "+e);return e},a.evalDef=function(e){var t=this;if(e.eval)try{var i=t.eval(e.eval);i&&(e=n.extend({},e,i),e.fields&&(e.fields=e.fields.map(function(e){return e=s.expandDef(e,t.form.store.templateMap),s.compileDef(e)})),e=s.compileDef(e))}catch(o){console.log("Problem in eval: ",JSON.stringify(e.eval)),console.log(o.message),console.log(o.stack)}return e},a.eval=function(e,t){return o.evaluate(e,this,t)},a.createChild=function(e){var t=this;e=t.resolve(e);var o=t.value;e=t.evalDef(e),o=i.isBlank(e.key)?e.value:o&&!n.isUndefined(o[e.key])?o[e.key]:void 0;var s=new r(t.form,e,o,t);return t.tempChildren.push(s),s},a.itemForValue=function(e){var t=this,o=n.find(t.items(),function(t){return i.itemMatchesValue(t,e)});return o=o?n.extend({},o):i.fieldDefFromValue(e)},a.groupFields=function(e,t){var n=this;if(!n.groups[e]&&(n.groups[e]=[],n.parent)){var i=n.parent.fields();i.forEach(function(t){t!==n&&t.def.group===e&&n.groups[e].push(t)});var o=n.parent.groupFields(e,!0);n.groups[e]=n.groups[e].concat(o)}if(!t&&0===n.groups[e].length){var s=[];return n.tempChildren.forEach(function(t){t.def.group===e&&s.push(t)}),s}return n.groups[e]},a.valuePath=function(e){var t=this,n=e||[];return i.isBlank(t.def.key)||(n=[t.def.key].concat(n)),t.parent?t.parent.valuePath(n):n},a.val=function(e){var t=this;t.form.actions.setValue(t.valuePath(),e)},a.remove=function(e){var t=this,n=t.valuePath().concat(e);t.form.actions.removeValue(n)},a.move=function(e,t){var n=this;n.form.actions.moveValue(n.valuePath(),e,t)},a.default=function(){var e=this;return n.isUndefined(e.def.value)?n.isUndefined(e.def.default)?n.isUndefined(e.typePlugin().default)?null:i.copyValue(e.typePlugin().default):i.copyValue(e.def.default):i.copyValue(e.def.value)},a.append=function(e){var t=this,o=t.items()[e];o=n.extend(o),o.key=t.value.length;var s=t.createChild(o),r=s.default();if(n.isArray(r)||n.isObject(r)){var a=t.valuePath().length+1;s.inflate(function(e,t){r=i.setIn(r,e.slice(a),t)})}t.form.actions.appendValue(t.valuePath(),r)},a.hidden=function(){var e=this;return e.def.hidden||e.typePlugin().hidden},a.inflate=function(e){var t=this;!i.isBlank(t.def.key)&&n.isUndefined(t.value)&&e(t.valuePath(),t.default());var o=t.fields();o.forEach(function(t){t.inflate(e)})},a.erase=function(){var e=this;i.isBlank(e.def.key)||n.isUndefined(e.value)||e.form.actions.eraseValue(e.valuePath(),{})}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],30:[function(e,t){"use strict";t.exports=function(e){var t=e.requireAll(e.config.init),n=e.exports;n.init=function(){var e=this;t.forEach(function(t){t.apply(e,arguments)})}}},{}],31:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=e("eventemitter3");t.exports=function(e){var t=e.exports,n=e.require(e.config.store),s=e.require("util"),r=e.require("loader"),a=function(e,t){var n={};return t.forEach(function(t){n[t]=function(){e[t].apply(e,arguments)}}),n};t.init=function(e){var t=this;e=e||{};var i=new o;t.store=n(t,i,e),t.actions=a(t.store,["setValue","setFields","removeValue","appendValue","moveValue","eraseValue","setMeta"]),t.store.inflate(),t.on=i.on.bind(i),t.off=i.off.bind(i),t.once=i.once.bind(i)},t.component=function(t){var n=this;t=i.extend({},t,{form:n});var o=e.component("formatic");return o(t)},t.val=function(e){var t=this;return i.isUndefined(e)?s.copyValue(t.store.value):t.actions.setValue(e)},t.fields=function(e){var t=this;t.actions.setFields(e)},t.findDef=function(e){var t=this;return t.store.templateMap[e]||null},t.meta=function(e,t){var n=this;return i.isUndefined(t)?n.store.meta[e]:n.actions.setMeta(e,t)},t.loadMeta=function(e,t){t=t||{};var n=Object.keys(t),i=n.filter(function(e){return t[e]});i.length<n.length||r.loadMeta(this,e,t)},t.source=r.source}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{eventemitter3:59}],32:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null;t.exports=function(e){var t=e.exports,i=e.require("field-router");t.route=i.route,t.render=function(e,t){n.renderComponent(e,t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t=e.requireAll(e.config.compilers),i=e.require("util"),o=e.exports;o.templateMap=function(e){var t={};return e.forEach(function(e){e.key&&(t[e.key]=e),e.id&&(t[e.id]=e)}),t},o.expandDef=function(e,t){var i=e.template,s=e.extends;if(n.isString(s)&&(s=[s]),s){var r=s.map(function(e){var n=t[e];if(!n)throw new Error("Template "+e+" not found.");return n}),a=[{}].concat(r.reverse().concat([e]));e=n.extend.apply(n,a)}return e.fields&&(e.fields=e.fields.map(function(e){return n.isString(e)?e:o.expandDef(e,t)})),e.items&&(e.items=e.items.map(function(e){return n.isString(e)?e:o.expandDef(e,t)})),!i&&e.template&&delete e.template,e},o.expandFields=function(e){var t=o.templateMap(e);return e.map(function(e){return o.expandDef(e,t)})},o.compileDef=function(s){s=i.deepCopy(s);var r;t.forEach(function(e){r=e.compile(s),r&&(s=r)});var a=e.require("type."+s.type);return a.compile&&(r=a.compile(s),r&&(s=r)),s.fields&&(s.fields=s.fields.map(function(e){return n.isObject(e)?o.compileDef(e):e})),s},o.compileFields=function(e){return e.map(function(e){return o.compileDef(e)})}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null;t.exports=function(e){var t={},i=function(e,n){t[e]||(t[e]=[]),t[e].push(n)},o=e.requireAll(e.config.props);o.forEach(function(e){i.apply(null,e)});var s={};e.exports.component=function(i){if(!s[i]){var o=n.createFactory(e.require("component."+i));s[i]=function(e,n){return t[i]&&t[i].forEach(function(t){var n=t(e);n&&(e=n)}),o(e,n)}}return s[i]}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){e.exports=function(t){var i=e.requireAll(e.config.formatic),o=e.requireAll(e.config.form);i.forEach(function(e){n.keys(e).forEach(function(i){if(!n.isUndefined(t[i]))throw new Error("Property already defined for formatic: "+i);t[i]=e[i]})});var s=function(e){this.init&&this.init(e)};t.form=function(e){return new s(e)},s.prototype=t.form;var r=[];o.forEach(function(e){n.keys(e).forEach(function(t){if("init"===t)r.push(e[t]);else{if(!n.isUndefined(s.prototype[t]))throw new Error("Property already defined for form: "+t);s.prototype[t]=e[t]}})}),s.prototype.init=0===r.length?function(){}:1===r.length?r[0]:function(){var e=this,t=arguments;r.forEach(function(n){n.apply(e,t)})}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i=function(e){return function(t){t.exports=function(t,n,i){t=n.eval(t,i);var o=e.apply(null,t);return o}}},o=function(e){return function(t){t.exports=function(t,n,i){return t=n.eval(t,i),t.length>0?t[0][e].apply(t[0],t.slice(1)):void 0}}},s={"if":function(e){e.exports=function(e,t,n){return t.eval(e[0],n)?t.eval(e[1],n):t.eval(e[2],n)}},eq:function(e){e.exports=function(e,t,n){return t.eval(e[0],n)===t.eval(e[1],n)}},not:function(e){e.exports=function(e,t,n){return!t.eval(e[0],n)}},or:function(e){e.exports=function(e,t,n){for(var i=0;i<e.length;i++){var o=t.eval(e[i],n);if(o)return o}return e[e.length-1]}},and:function(e){e.exports=function(e,t,n){for(var i=0;i<e.length;i++){var o=t.eval(e[i],n);if(!o||i===e.length-1)return o}return void 0}},get:function(e){var t=e.exports=function(i,o,s){var r,a=e.require("util"),l=o.eval(i[0],s);if(s&&l in s?r=s[l]:n.isObject(o.value)&&l in o.value?r=o.value[l]:o.parent&&(r=t(i,o.parent)),i.length>1){var f=o.eval(i.slice(1),s);return a.getIn(r,f)}return r}},getGroupValues:function(e){e.exports=function(e,t,n){var i=t.eval(e[0],n),o=t.groupFields(i);return o.map(function(e){return e.value})}},getMeta:function(e){var t=e.require("util");e.exports=function(e,n,i){e=n.eval(e,i);var o=t.metaCacheKey(e[0],e[1]);return n.form.meta(o)}},sum:function(e){e.exports=function(e,t,n){for(var i=0,o=0;o<e.length;o++)i+=t.eval(e[o],n);return i}},forEach:function(e){e.exports=function(e,t,i){var o=e[0],s=t.eval(e[1],i),r=e[2],a=e[3];i=Object.create(i||{});for(var l=[],f=0;f<s.length;f++){var c=s[f];i[o]=c,(n.isUndefined(a)||t.eval(a,i))&&l.push(t.eval(r,i))}return l}},concat:o("concat"),split:o("split"),reverse:o("reverse"),join:o("join"),humanize:function(e){var t=e.require("util");e.exports=function(e,n,i){return t.humanize(n.eval(e[0],i))}},pick:i(n.pick),pluck:i(n.pluck)};n.each(s,function(e,n){t.exports["eval-function."+n]=e})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t=e.requireAllOf("eval-function"),i={};n.each(t,function(e,t){var n=t.substring(t.indexOf(".")+1);i[n]=e});var o=function(e){return e.length>0&&"@"===e[0][0]},s=function(e,t,n){var o=e[0].substring(1);try{return i[o](e.slice(1),t,n)}catch(s){if(!(o in i))throw new Error("Eval function "+o+" not defined.");throw s}},r=function(e,t,a){if(n.isArray(e))return o(e)?s(e,t,a):e.map(function(e){return r(e,t,a)});if(n.isObject(e)){var l={};return Object.keys(e).forEach(function(n){var i=r(e[n],t,a);"undefined"!=typeof i&&(l[n]=i)}),l}return n.isString(e)&&"="===e[0]?i.get([e.substring(1)],t,a):e};e.exports.evaluate=r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],38:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t={},i=e.exports,o=e.requireAll(e.config.routes);i.route=function(e,n,i){t[e]||(t[e]=[]),t[e].push({component:n,test:i})},o.forEach(function(e){i.route.apply(i,e)}),i.componentForField=function(i){var o=i.def.type;if(t[o]){var s=t[o],r=n.find(s,function(e){return!e.test||e.test(i)});if(r)return e.component(r.component)}if(e.hasComponent(o))return e.component(o);throw new Error("No component for field: "+JSON.stringify(i.def))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],39:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i={"object.default":["object","fieldset"],"string.choices":["string","select",function(e){return e.def.choices?!0:!1}],"string.tags":["string","pretty-textarea",function(e){return e.def.replaceChoices}],"string.single-line":["string","text",function(e){return 1===e.def.maxRows}],"string.default":["string","textarea"],"array.choices":["array","checkbox-list",function(e){return e.def.choices?!0:!1}],"array.default":["array","list"],"boolean.default":["boolean","select"],"number.default":["number","text"]};n.each(i,function(e,n){t.exports["field-route."+n]=function(t){t.exports=e}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],40:[function(e,t){"use strict";t.exports=function(e){var t=e.require("util"),n=e.exports,i={},o={};n.loadMeta=function(e,o,s){var r=t.metaCacheKey(o,s);i[r]||(i[r]=!0,n.loadAsyncFromSource(e,o,s))},n.loadAsyncFromSource=function(e,t,i,o){setTimeout(function(){n.loadFromSource(e,t,i)},o||0)},n.loadFromSource=function(e,n,s){var r=o[n];if(r){var a=t.metaCacheKey(n,s),l=r.call(null,s);if(l)if(l.then){var f=l.then(function(t){e.meta(a,t),i[a]=!1}),c=function(){i[a]=!1};f.catch?f.catch(c):f.fail(c)}else setTimeout(function(){e.meta(a,l),i[a]=!1},0);else i[a]=!1}else i[a]=!1},n.source=function(e,t){o[e]=t}}},{}],41:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t=e.exports;t.isBlank=function(e){return void 0===e||null===e||""===e},t.setIn=function(e,i,o){return n.isString(i)&&(i=[i]),0===i.length?o:1===i.length?(e[i[0]]=o,e):(e[i[0]]||(e[i[0]]={}),t.setIn(e[i[0]],i.slice(1),o),e)},t.removeIn=function(e,i){return n.isString(i)&&(i=[i]),0===i.length?null:1===i.length?(n.isArray(e)?n.isNumber(i[0])&&e.splice(i[0],1):n.isObject(e)&&delete e[i[0]],e):(e[i[0]]&&t.removeIn(e[i[0]],i.slice(1)),e)},t.getIn=function(e,i){return n.isString(i)&&(i=[i]),0===i.length?e:n.isObject(e)&&i[0]in e?t.getIn(e[i[0]],i.slice(1)):null},t.appendIn=function(e,i,o){var s=t.getIn(e,i);return n.isArray(s)&&s.push(o),e},t.moveIn=function(e,i,o,s){var r=t.getIn(e,i);if(n.isArray(r)){if(n.isNumber(o)&&n.isNumber(s)){var a=o,l=s;a!==l&&a>=0&&a<r.length&&l>=0&&l<r.length&&r.splice(l,0,r.splice(a,1)[0])}}else{var f=r[o];r[o]=r[s],r[s]=f}return e},t.copyValue=function(e){return JSON.parse(JSON.stringify(e))},t.deepCopy=function(e){if(n.isArray(e))return e.map(function(e){return t.deepCopy(e)});if(n.isObject(e)){var i={};return n.each(e,function(e,n){i[n]=t.deepCopy(e)}),i}return e},t.itemMatchesValue=function(e,t){var i=e.match;return i?n.every(n.keys(i),function(e){return n.isEqual(i[e],t[e])}):!0},t.fieldDefFromValue=function(e){var i={type:"json"};if(n.isString(e))i={type:"string"};else if(n.isNumber(e))i={type:"number"};else if(n.isArray(e)){var o=e.map(function(e,n){var i=t.fieldDefFromValue(e);return i.key=n,i});i={type:"array",fields:o}}else if(n.isObject(e)){var s=Object.keys(e).map(function(n){var i=t.fieldDefFromValue(e[n]);return i.key=n,i.label=t.humanize(n),i});i={type:"object",fields:s}}else n.isNull(e)&&(i={type:"null"});return i},t.humanize=e.config.humanize?e.require(e.config.humanize):function(e){return e=e.replace(/\{\{/g,""),e=e.replace(/\}\}/g,""),e.replace(/_/g," ").replace(/(\w+)/g,function(e){return e.charAt(0).toUpperCase()+e.slice(1)})},t.className=function(){var e=Array.prototype.slice.call(arguments,0);return e=e.filter(function(e){return e}),e.join(" ")},t.joinMetaKeys=function(e){return e.join("::")},t.splitMetaKey=function(e){return e.split("::")},t.metaCacheKey=function(e,t){return t=t||{},e+"::params("+JSON.stringify(t)+")"};var i=function(e,t){return t=t||"text",{type:t,value:e}};t.parseTextWithTags=function(e){e=e||"";var t=e.split(/{{(?!{)/),n=[];return""!==t[0]&&(n=[i(t[0])]),t=n.concat(t.slice(1).map(function(e){return e.indexOf("}}")>=0?[i(e.substring(0,e.indexOf("}}")),"tag"),i(e.substring(e.indexOf("}}")+2))]:i("{{"+e,"text")})),[].concat.apply([],t)},t.copyElementStyle=function(e,t){var n=window.getComputedStyle(e,"");if(""!==n.cssText)return void(t.style.cssText=n.cssText);for(var i=[],o=0;o<n.length;o++)i.push(n[o]+":"+n.getPropertyValue(n[o])+";");var s=i.join("");t.style.cssText=s};var o={isChrome:!1,isMozilla:!1,isOpera:!1,isIe:!1,isSafari:!1},s=navigator.userAgent;s.indexOf("Chrome")>-1?o.isChrome=!0:s.indexOf("Safari")>-1?o.isSafari=!0:s.indexOf("Opera")>-1?o.isOpera=!0:s.indexOf("Firefox")>-1?o.isMozilla=!0:s.indexOf("MSIE")>-1&&(o.isIe=!0),t.browser=o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],42:[function(e,t){(function(n){"use strict";var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=i.DOM,s="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,r={},a={},l=0,f=function(e,t){if(r[e])throw new Error("Plugin "+e+" is already registered.");if(s.isArray(t))r[e]=[],t.forEach(function(t){f(t.name,t.plugin),r[e].push(t.name)});else if(s.isObject(t)&&!s.isFunction(t)){var n=e;r[n]=[],Object.keys(t).forEach(function(e){f(e,t[e]),r[n].push(e)})}else if(r[e]=t,e.indexOf(".")>0){var i=e.substring(0,e.indexOf("."));a[i]=a[i]||[],a[i].push(e)}},c={core:{formatic:["core.formatic"],form:["core.form-init","core.form","core.field"]},"core.form":{store:"store.memory"},"field-router":{routes:["field-routes"]},compiler:{compilers:["compiler.choices","compiler.lookup","compiler.types","compiler.prop-aliases"]},component:{props:["default-style"]}},u=function(e){e=s.extend({},e),s.keys(c).forEach(function(t){e[t]=s.extend({},c[t],e[t])});var t,n={},i=function(e,t){return this instanceof i?(this.exports={},this.config=t||{},void(this.name=e)):new i(e,t)};i.prototype.configValue=function(e,t){return"undefined"!=typeof this.config[e]?this.config[e]:t||""},i.prototype.require=function(e){return t.plugin(e)};var o;i.prototype.component=function(e){return o.component(e)},i.prototype.hasPlugin=function(e){return e in n||e in r},i.prototype.hasComponent=function(e){return this.hasPlugin("component."+e)},i.prototype.requireAll=function(e){return e||(e=[]),s.isArray(e)||(e=[e]),e=e.map(function(e){return s.isString(e)&&s.isArray(r[e])?r[e]:e}),e=s.flatten(e),e.map(function(e){return this.require(e)}.bind(this))},i.prototype.requireAllOf=function(e){var t={};return a[e]&&a[e].forEach(function(e){t[e]=this.require(e)}.bind(this)),t};var u=function(t,o){var a;if(s.isFunction(t)){var f=t;return s.isUndefined(f.__exports__)&&(l++,a=i("anonymous_plugin_"+l,o||{}),f(a),f.__exports__=a.exports),f.__exports__}if(s.isUndefined(n[t])){if(!o&&e[t]&&e[t].plugin)return u(e[t].plugin,e[t]||{});if(!r[t])throw new Error("Plugin "+t+" not found.");if(!s.isFunction(r[t]))throw new Error("Plugin "+t+" is not a function.");a=i(t,o||e[t]),r[t](a),n[t]=a.exports}return n[t]};t=function(e){return t.form(e)},t.register=function(e,n){return f(e,n),t},t.plugin=function(e){return u(e)};var d=u("core");return d(t),o=u("component"),t},d=function(){var e=s.toArray(arguments);e.forEach(function(e){var t=e[0],n=e[1];f(t,n)})};d(["core",e("./default/core")],["core.formatic",e("./core/formatic")],["core.form-init",e("./core/form-init")],["core.form",e("./core/form")],["core.field",e("./core/field")],["util",e("./default/util")],["compiler",e("./default/compiler")],["eval",e("./default/eval")],["eval-functions",e("./default/eval-functions")],["loader",e("./default/loader")],["field-router",e("./default/field-router")],["field-routes",e("./default/field-routes")],["compiler.choices",e("./compilers/choices")],["compiler.lookup",e("./compilers/lookup")],["compiler.types",e("./compilers/types")],["compiler.prop-aliases",e("./compilers/prop-aliases")],["store.memory",e("./store/memory")],["type.root",e("./types/root")],["type.string",e("./types/string")],["type.object",e("./types/object")],["type.boolean",e("./types/boolean")],["type.array",e("./types/array")],["type.json",e("./types/json")],["type.number",e("./types/number")],["component",e("./default/component")],["component.formatic",e("./components/formatic")],["component.root",e("./components/root")],["component.field",e("./components/field")],["component.label",e("./components/label")],["component.help",e("./components/help")],["component.sample",e("./components/sample")],["component.fieldset",e("./components/fieldset")],["component.text",e("./components/text")],["component.textarea",e("./components/textarea")],["component.select",e("./components/select")],["component.list",e("./components/list")],["component.list-control",e("./components/list-control")],["component.list-item",e("./components/list-item")],["component.list-item-value",e("./components/list-item-value")],["component.list-item-control",e("./components/list-item-control")],["component.item-choices",e("./components/item-choices")],["component.add-item",e("./components/add-item")],["component.remove-item",e("./components/remove-item")],["component.move-item-back",e("./components/move-item-back")],["component.move-item-forward",e("./components/move-item-forward")],["component.json",e("./components/json")],["component.checkbox-list",e("./components/checkbox-list")],["component.pretty-textarea",e("./components/pretty-textarea")],["component.choices",e("./components/choices")],["mixin.click-outside",e("./mixins/click-outside")],["mixin.field",e("./mixins/field")],["mixin.input-actions",e("./mixins/input-actions")],["mixin.resize",e("./mixins/resize")],["mixin.scroll",e("./mixins/scroll")],["mixin.undo-stack",e("./mixins/undo-stack")],["bootstrap-style",e("./plugins/bootstrap-style")],["default-style",e("./plugins/default-style")]);var p=function(e){var t=u(e);return i.createClass({displayName:"Formatic",statics:{config:p,form:t,plugin:t.plugin},getInitialState:function(){var e=this.props.form||this.props.defaultForm;return{form:e,field:e.field(),controlled:this.props.form?!0:!1}},componentDidMount:function(){var e=this.state.form;if(!e)throw new Error("Must supply a form or defaultForm.");this.state.controlled?e.once("change",this.onFormChanged):e.on("change",this.onFormChanged)},onFormChanged:function(){this.props.onChange&&this.props.onChange(this.props.form.val()),this.state.controlled||this.setState({field:this.state.form.field()})},componentWillUnmount:function(){var e=this.state.form;e&&e.off("change",this.onFormChanged)},componentWillReceiveProps:function(e){if(this.state.controlled){if(!e.form)throw new Error("Must supply a new form for a controlled component.");e.form.once("change",this.onFormChanged),this.setState({form:e.form,field:e.form.field()})}},render:function(){return o.div({className:"formatic"},this.state.field.component())}})};t.exports=p()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./compilers/choices":1,"./compilers/lookup":2,"./compilers/prop-aliases":3,"./compilers/types":4,"./components/add-item":5,"./components/checkbox-list":6,"./components/choices":7,"./components/field":8,"./components/fieldset":9,"./components/formatic":10,"./components/help":11,"./components/item-choices":12,"./components/json":13,"./components/label":14,"./components/list":19,"./components/list-control":15,"./components/list-item":18,"./components/list-item-control":16,"./components/list-item-value":17,"./components/move-item-back":20,"./components/move-item-forward":21,"./components/pretty-textarea":22,"./components/remove-item":23,"./components/root":24,"./components/sample":25,"./components/select":26,"./components/text":27,"./components/textarea":28,"./core/field":29,"./core/form":31,"./core/form-init":30,"./core/formatic":32,"./default/compiler":33,"./default/component":34,"./default/core":35,"./default/eval":37,"./default/eval-functions":36,"./default/field-router":38,"./default/field-routes":39,"./default/loader":40,"./default/util":41,"./mixins/click-outside":43,"./mixins/field":44,"./mixins/input-actions":45,"./mixins/resize":46,"./mixins/scroll":47,"./mixins/undo-stack":48,"./plugins/bootstrap-style":49,"./plugins/default-style":50,"./store/memory":51,"./types/array":52,"./types/boolean":53,"./types/json":54,"./types/number":55,"./types/object":56,"./types/root":57,"./types/string":58}],43:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i=function(e,t){return e.parentNode===t?!0:null===e.parentNode?!1:i(e.parentNode,t)};t.exports=function(e){e.exports={isNodeOutside:function(e,t){return e===t?!1:i(e,t)?!1:!0},isNodeInside:function(e,t){return!this.isNodeOutside(e,t)},_onClickMousedown:function(){n.each(this.clickOutsideHandlers,function(e,t){this.refs[t]&&(this._mousedownRefs[t]=!0)}.bind(this))},_onClickMouseup:function(e){n.each(this.clickOutsideHandlers,function(t,n){this.refs[n]&&this._mousedownRefs[n]&&this.isNodeOutside(e.target,this.refs[n].getDOMNode())&&t.forEach(function(t){t.call(this,e)}.bind(this)),this._mousedownRefs[n]=!1}.bind(this))},setOnClickOutside:function(e,t){this.clickOutsideHandlers[e]||(this.clickOutsideHandlers[e]=[]),this.clickOutsideHandlers[e].push(t)},componentDidMount:function(){this.clickOutsideHandlers={},this._didMouseDown=!1,document.addEventListener("mousedown",this._onClickMousedown),document.addEventListener("mouseup",this._onClickMouseup),this._mousedownRefs={}},componentWillUnmount:function(){this.clickOutsideHandlers={},document.removeEventListener("mouseup",this._onClickMouseup),document.removeEventListener("mousedown",this._onClickMousedown)}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],44:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){e.exports={loadNeededMeta:function(e){if(e.field&&e.field.form&&e.field.def.needsMeta&&e.field.def.needsMeta.length>0){var t=[];e.field.def.needsMeta.forEach(function(e){n.isArray(e)&&e.length>0&&(n.isArray(e[0])?e.forEach(function(e){t.push(e)}):t.push(e))}),0===t.length&&(t=[e.field.def.needsMeta]),t.forEach(function(t){t&&e.field.form.loadMeta.apply(e.field.form,t)})}},componentDidMount:function(){this.loadNeededMeta(this.props)},componentWillReceiveProps:function(e){this.loadNeededMeta(e)},componentWillUnmount:function(){}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(e,t){"use strict";t.exports=function(e){e.exports={onFocus:function(){},onBlur:function(){},onChange:function(){}}}},{}],46:[function(e,t){"use strict";var n=0,i={},o=0,s=null,r=function(){Object.keys(i).forEach(function(e){var t=i[e];if(t.clientWidth!==t.__prevClientWidth||t.clientHeight!==t.__prevClientHeight){t.__prevClientWidth=t.clientWidth,t.__prevClientHeight=t.clientHeight;var n=t.__resizeHandlers;n.forEach(function(e){e()})}},100)},a=function(e,t){null===s&&(s=setInterval(r,100)),"__resizeId"in e||(n++,e.__prevClientWidth=e.clientWidth,e.__prevClientHeight=e.clientHeight,e.__resizeId=n,o++,i[n]=e,e.__resizeHandlers=[]),e.__resizeHandlers.push(t)},l=function(e){if("__resizeId"in e){var t=e.__resizeId;delete e.__resizeId,delete e.__resizeHandlers,delete i[t],o--,1>o&&(clearInterval(s),s=null)}},f=function(e,t){t(e)};t.exports=function(e){e.exports={componentDidMount:function(){this.onResizeWindow&&window.addEventListener("resize",this.onResizeWindow),this.resizeElementRefs={}},componentWillUnmount:function(){this.onResizeWindow&&window.removeEventListener("resize",this.onResizeWindow),Object.keys(this.resizeElementRefs).forEach(function(e){l(this.refs[e].getDOMNode())}.bind(this))},setOnResize:function(e,t){this.resizeElementRefs[e]||(this.resizeElementRefs[e]=!0),a(this.refs[e].getDOMNode(),f.bind(this,e,t))}}}},{}],47:[function(e,t){"use strict";t.exports=function(e){e.exports={componentDidMount:function(){this.onScrollWindow&&window.addEventListener("scroll",this.onScrollWindow)},componentWillUnmount:function(){this.onScrollWindow&&window.removeEventListener("scroll",this.onScrollWindow)}}}},{}],48:[function(e,t){"use strict";var n={getInitialState:function(){return{undo:[],redo:[]}},snapshot:function(){var e=this.state.undo.concat(this.getStateSnapshot());"number"==typeof this.state.undoDepth&&e.length>this.state.undoDepth&&e.shift(),this.setState({undo:e,redo:[]})},hasUndo:function(){return this.state.undo.length>0},hasRedo:function(){return this.state.redo.length>0},redo:function(){this._undoImpl(!0)},undo:function(){this._undoImpl()},_undoImpl:function(e){var t,n=this.state.undo.slice(0),i=this.state.redo.slice(0);if(e){if(0===i.length)return;t=i.pop(),n.push(this.getStateSnapshot())}else{if(0===n.length)return;t=n.pop(),i.push(this.getStateSnapshot())}this.setStateSnapshot(t),this.setState({undo:n,redo:i})}};t.exports=function(e){e.exports=n}},{}],49:[function(e,t,n){(function(e){"use strict";var t="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i={field:{className:"form-group"},help:{className:"help-block"},sample:{className:"help-block"},text:{className:"form-control"},textarea:{className:"form-control"},"pretty-textarea":{className:"form-control"},json:{className:"form-control"},select:{className:"form-control"},"list-control":{className:"form-inline"},"list-item":{className:"well"},"item-choices":{className:"form-control"},"add-item":{className:"glyphicon glyphicon-plus",label:""},"remove-item":{className:"glyphicon glyphicon-remove",label:""},"move-item-back":{className:"glyphicon glyphicon-arrow-up",label:""},"move-item-forward":{className:"glyphicon glyphicon-arrow-down",label:""}};t.each(i,function(e,i){n["component-props."+i+".bootstrap"]=function(n){var o=n.require("util");n.exports=[i,function(n){t.isUndefined(e.className)||(n.className=o.className(n.className,e.className)),t.isUndefined(e.label)||(n.label=e.label)}]}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})
},{}],50:[function(e,t,n){(function(e){"use strict";var t="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,i={field:{},help:{},sample:{},text:{},textarea:{},"pretty-textarea":{},json:{},select:{},list:{},"list-control":{},"list-item-control":{},"list-item-value":{},"list-item":{},"item-choices":{},"add-item":{},"remove-item":{},"move-item-back":{},"move-item-forward":{}};t.each(i,function(e,t){n["component-props."+t+".default"]=function(e){var n=e.require("util");e.exports=[t,function(e){e.className=n.className(e.className,t)}]}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],51:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t=e.require("compiler"),i=e.require("util");e.exports=function(e,o,s){var r={};r.fields=[],r.templateMap={},r.value={},r.meta={};var a=function(e){r.fields=t.expandFields(e),r.fields=t.compileFields(r.fields),r.templateMap=t.templateMap(r.fields),r.fields=r.fields.filter(function(e){return!e.template})};s.fields&&a(s.fields),n.isUndefined(s.value)||(r.value=i.copyValue(s.value));var l=function(e){o.emit("change",{value:r.value,meta:r.meta,fields:r.fields,changing:e})};r.inflate=function(){var t=e.field();t.inflate(function(e,t){r.value=i.setIn(r.value,e,t)})};var f={setValue:function(e,t){n.isUndefined(t)&&(t=e,e=[]);var o=i.getIn(r.value,e);0===e.length?(r.value=i.copyValue(t),r.inflate()):r.value=i.setIn(r.value,e,t),l({path:e,"new":t,old:o,action:"set"})},removeValue:function(e){var t=i.getIn(r.value,e);r.value=i.removeIn(r.value,e),l({path:e,old:t,action:"remove"})},eraseValue:function(e){r.value=i.removeIn(r.value,e),l({})},appendValue:function(e,t){var n=i.getIn(r.value,e);r.value=i.appendIn(r.value,e,t),l({path:e,"new":t,old:n,action:"append"})},moveValue:function(e,t,n){var o=i.getIn(r.value,e);r.value=i.moveIn(r.value,e,t,n),l({path:e,"new":o,old:o,fromKey:t,toKey:n,action:"move"})},setFields:function(e){a(e),r.inflate(),l({action:"setFields"})},setMeta:function(e,t){r.meta[e]=t,l({action:"setMeta"})}};return n.extend(r,f),r}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],52:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){e.exports.default=[],e.exports.fields=function(e){return n.isArray(e.value)?e.value.map(function(t,n){var i=e.itemForValue(t);return i.key=n,e.createChild(i)}):[]}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],53:[function(e,t){"use strict";t.exports=function(e){e.exports.default=!1,e.exports.compile=function(e){e.choices||(e.choices=[{value:!0,label:"Yes"},{value:!1,label:"No"}])}}},{}],54:[function(e,t){"use strict";t.exports=function(e){e.exports.default=null}},{}],55:[function(e,t){"use strict";t.exports=function(e){e.exports.default=0}},{}],56:[function(e,t){(function(e){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null;t.exports=function(e){var t=e.require("util");e.exports.default={},e.exports.fields=function(e){var i=[],o=e.value,s=n.keys(o);return e.def.fields&&(i=e.def.fields.map(function(i){var o=e.createChild(i);return t.isBlank(o.def.key)||(s=n.without(s,o.def.key)),o})),s.length>0&&s.forEach(function(n){var s=e.itemForValue(o[n]);s.label=t.humanize(n),s.key=n,i.push(e.createChild(s))}),i}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],57:[function(e,t){"use strict";t.exports=function(e){e.exports.fields=function(e){return e.form.store.fields.map(function(t){return e.createChild(t)})}}},{}],58:[function(e,t){"use strict";t.exports=function(e){e.exports.default=""}},{}],59:[function(e,t){"use strict";function n(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(){}i.prototype._events=void 0,i.prototype.listeners=function(e){if(!this._events||!this._events[e])return[];for(var t=0,n=this._events[e].length,i=[];n>t;t++)i.push(this._events[e][t].fn);return i},i.prototype.emit=function(e,t,n,i,o,s){if(!this._events||!this._events[e])return!1;var r,a,l,f=this._events[e],c=f.length,u=arguments.length,d=f[0];if(1===c){switch(d.once&&this.removeListener(e,d.fn,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,n),!0;case 4:return d.fn.call(d.context,t,n,i),!0;case 5:return d.fn.call(d.context,t,n,i,o),!0;case 6:return d.fn.call(d.context,t,n,i,o,s),!0}for(a=1,r=new Array(u-1);u>a;a++)r[a-1]=arguments[a];d.fn.apply(d.context,r)}else for(a=0;c>a;a++)switch(f[a].once&&this.removeListener(e,f[a].fn,!0),u){case 1:f[a].fn.call(f[a].context);break;case 2:f[a].fn.call(f[a].context,t);break;case 3:f[a].fn.call(f[a].context,t,n);break;default:if(!r)for(l=1,r=new Array(u-1);u>l;l++)r[l-1]=arguments[l];f[a].fn.apply(f[a].context,r)}return!0},i.prototype.on=function(e,t,i){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(new n(t,i||this)),this},i.prototype.once=function(e,t,i){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(new n(t,i||this,!0)),this},i.prototype.removeListener=function(e,t,n){if(!this._events||!this._events[e])return this;var i=this._events[e],o=[];if(t)for(var s=0,r=i.length;r>s;s++)i[s].fn!==t&&i[s].once!==n&&o.push(i[s]);return this._events[e]=o.length?o:null,this},i.prototype.removeAllListeners=function(e){return this._events?(e?this._events[e]=null:this._events={},this):this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.EventEmitter=i,i.EventEmitter2=i,i.EventEmitter3=i,"object"==typeof t&&t.exports&&(t.exports=i)},{}],formatic:[function(e,t){t.exports=e("./lib/formatic")},{"./lib/formatic":42}]},{},[])("formatic")});