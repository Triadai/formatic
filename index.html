<!DOCTYPE html>
<html>
<head>
  <link href="./style/formatic.css" rel="stylesheet" type="text/css"/>
</head>
<body>
  <div id="user"></div>
  <div id="extra"></div>
  <div id="json"></div>
  <script src="./formatic-dev.js"></script>
  <script>
    var formatic = require('formatic')('react');

    formatic.config({
      typeMap: {
        unicode: 'text'
      }
    });

    var form = formatic();

    form.meta('prettyTextareaLabels', {
      'field1': 'First Name',
      'field2': 'Last Name',
      'field3': 'First Name',
      'longfield1': 'Shorty'
    });

    var humanize = function(property) {
      property = property.replace(/\{\{/g, '');
      property = property.replace(/\}\}/g, '');
      return property.replace(/_/g, ' ')
        .replace(/(\w+)/g, function(match) {
          return match.charAt(0).toUpperCase() + match.slice(1);
        });
    };

    form.meta('prettyTextareaLabelFallback', humanize);

    form.fields([
      /*
      {
        type: 'text',
        key: 'name.first',
        label: 'First Name',
        required: true
      },
      {
        type: 'unicode',
        key: 'name.last',
        label: 'Last Name',
        required: true
      },
      */

      {
        type: 'textarea',
        key: 'foo',
        label: 'Foo'
      },
{
        type: 'pretty-textarea',
        key: 'party',
        label: 'Party'
      }
      /*,
      {
        type: 'text',
        key: 'address.city',
        label: 'City'
      },
      {
        type: 'select',
        key: 'address.state',
        label: 'State',
        choices: ['MO', 'IL']
      },
      {
        type: 'dropdown',
        key: 'os',
        label: 'Operating System',
        choices: [
          {value: 'osx', label: 'Mac OS X'},
          {value: 'linux', label: 'Linux'},
          {value: 'vista', label: 'Windows Vista'},
          {value: 'win7', label: 'Windows 7'},
          {value: 'win8', label: 'Windows 8'}
        ]
      },
      {
        type: 'dropdown',
        key: 'mood',
        label: 'How do you feel?',
        required: true,
        choices: {
          happy: 'Happy',
          sad: 'Sad'
        }
      },
      // Crazy experimental if type. Will dynamically return node depending on
      // expression (which is also made up of crazy experimental types).
      {
        type: 'if',
        fields: [
          {
            type: 'eq',
            fields: [
              {
                type: 'get',
                value: 'mood'
              },
              {
                type: 'string',
                value: 'sad'
              }
            ]
          },
          {
            type: 'code',
            value: 'So sorry!'
          },
          {
            type: 'code',
            value: "Glad you're feeling good!"
          }
        ]
      },
      // Even crazier experimental terse compiler used with if. Same expression
      // as above, but done with terse string.
      {
        type: 'if',
        fields: [
          "eq(get('mood'),'sad')",
          {
            type: 'code',
            value: 'Seriously, I feel bad about that!'
          }
          // leaving out else field
        ]
      },
      // Another terse compiler.
      "text:terseKey:Some terse field",
      "textarea:myKey:Some text area",
      {
        type: 'textarea',
        key: 'story',
        label: 'Tell me a story'
      },
      {
        type: 'text',
        label: 'Some readonly field',
        value: 'Some readonly value'
      },
      {
        type: 'password',
        key: 'password',
        label: 'What is your password?'
      },
      {
        type: 'checkbox',
        key: 'colors',
        label: 'Favorite colors',
        choices: ['red', 'green']
      },
      {
        type: 'checkbox',
        key: 'optIn',
        label: 'Send me stuff!'
      }*/
    ]);

    form.attach(document.getElementById('user'));

    jsonForm = formatic();

    jsonForm.attach(document.getElementById('json'));

    form.on('update', function () {
      jsonForm.fields([
        {
          type: 'code',
          value: JSON.stringify(form.val(), null, 2)
        }
      ]);
    });
  </script>
</body>
</html>
